
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>The PVMD Toolbox manual &#8212; PVMD Toolbox  documentation</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Style guide for the PVMD toolbox" href="../develop/style_guide.html" />
    <link rel="prev" title="Access guide to the PVMD Toolbox" href="../getting_started/access_guide.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">PVMD Toolbox  documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Getting started
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../getting_started/access_guide.html">
   Access guide to the PVMD Toolbox
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   The PVMD Toolbox manual
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Contributing
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../develop/style_guide.html">
   Style guide for the PVMD toolbox
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  API references
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../api/modules.html">
   PVMD Toolbox
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/pvmd.html">
     PVMD Toolbox
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../api/pvmd.1_cell.html">
     pvmd.1_cell
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Theme by the <a href="https://ebp.jupyterbook.org">Executable Book Project</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/user_guide/full_manual.rst.txt"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.rst</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   1. About
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow-diagram">
     1.1 Workflow Diagram
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-variable">
     1.2 Input Variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-variables">
     1.3 Output Variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-pre-requisites">
   2. Software pre-requisites
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matlab">
     2.1 Matlab
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#asa">
     2.2 ASA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#radiance">
     2.3 Radiance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installation-in-mac-os">
       2.3.1 Installation in Mac-OS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installation-in-windows">
       2.3.2 Installation in Windows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adapt-the-path">
       2.3.3 Adapt the path
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rhino-3d">
     2.4 Rhino 3D
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#before-running-the-toolbox">
       2.4.1 Before running the toolbox
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pvmd-toolbox-usage">
   3. PVMD toolbox usage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-gui-version">
     3.1 The GUI Version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cell">
       3.1.1 Cell
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module">
       3.1.2 Module
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#periodic-simulation">
         3.1.2.1 Periodic Simulation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#non-periodic-simulation">
         3.1.2.2 Non-periodic Simulation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#output-variable">
         3.1.2.3 Output variable
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#weather">
       3.1.3 Weather
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#thermal">
       3.1.4 Thermal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#electric">
       3.1.5 Electric
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#degradation">
       3.1.6 Degradation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       3.1.7 Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#financials">
       3.1.8 Financials
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pvmd-toolbox-script-version">
     3.2 PVMD Toolbox Script Version
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-limitations">
   4. Software limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#version-summary">
   5. Version summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgements">
   6. Acknowledgements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   7. References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   Appendix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-information-on-material-reflectances">
     A. Information on material reflectances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-information-on-radiance-subclasses-and-testpoints">
     B. Information on Radiance subclasses and testpoints
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-1-radiance-subclasses">
       B.1 Radiance subclasses
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-2-testpoints">
       B.2 Testpoints
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-downloading-tif-files-for-horizon-reconstruction">
     C. Downloading
     <em>
      .tif
     </em>
     files for horizon reconstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-user-specified-template-for-power-optimizers">
     D. User Specified template for power optimizers
    </a>
   </li>
  </ul>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>The PVMD Toolbox manual</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#about">
   1. About
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workflow-diagram">
     1.1 Workflow Diagram
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#input-variable">
     1.2 Input Variable
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#output-variables">
     1.3 Output Variables
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-pre-requisites">
   2. Software pre-requisites
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#matlab">
     2.1 Matlab
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#asa">
     2.2 ASA
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#radiance">
     2.3 Radiance
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installation-in-mac-os">
       2.3.1 Installation in Mac-OS
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#installation-in-windows">
       2.3.2 Installation in Windows
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#adapt-the-path">
       2.3.3 Adapt the path
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#rhino-3d">
     2.4 Rhino 3D
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#before-running-the-toolbox">
       2.4.1 Before running the toolbox
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#pvmd-toolbox-usage">
   3. PVMD toolbox usage
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#the-gui-version">
     3.1 The GUI Version
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#cell">
       3.1.1 Cell
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#module">
       3.1.2 Module
      </a>
      <ul class="nav section-nav flex-column">
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#periodic-simulation">
         3.1.2.1 Periodic Simulation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#non-periodic-simulation">
         3.1.2.2 Non-periodic Simulation
        </a>
       </li>
       <li class="toc-h5 nav-item toc-entry">
        <a class="reference internal nav-link" href="#output-variable">
         3.1.2.3 Output variable
        </a>
       </li>
      </ul>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#weather">
       3.1.3 Weather
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#thermal">
       3.1.4 Thermal
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#electric">
       3.1.5 Electric
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#degradation">
       3.1.6 Degradation
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#conversion">
       3.1.7 Conversion
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#financials">
       3.1.8 Financials
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#pvmd-toolbox-script-version">
     3.2 PVMD Toolbox Script Version
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#software-limitations">
   4. Software limitations
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#version-summary">
   5. Version summary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#acknowledgements">
   6. Acknowledgements
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#references">
   7. References
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#appendix">
   Appendix
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#a-information-on-material-reflectances">
     A. Information on material reflectances
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#b-information-on-radiance-subclasses-and-testpoints">
     B. Information on Radiance subclasses and testpoints
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-1-radiance-subclasses">
       B.1 Radiance subclasses
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#b-2-testpoints">
       B.2 Testpoints
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#c-downloading-tif-files-for-horizon-reconstruction">
     C. Downloading
     <em>
      .tif
     </em>
     files for horizon reconstruction
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#d-user-specified-template-for-power-optimizers">
     D. User Specified template for power optimizers
    </a>
   </li>
  </ul>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section id="the-pvmd-toolbox-manual">
<h1>The PVMD Toolbox manual<a class="headerlink" href="#the-pvmd-toolbox-manual" title="Permalink to this headline">#</a></h1>
<p>Developed by PVMD group (Photovoltaic Materials and Devices Group) at Delft University of Technology.</p>
<section id="about">
<span id="chapter-about"></span><h2>1. About<a class="headerlink" href="#about" title="Permalink to this headline">#</a></h2>
<p>The PVMD TOOLBOX is a MATLAB-based software package developed by the PhotoVoltaic Materials and Devices Group (PVMD Group) at the Delft University of Technology, Delft, the Netherlands. It is a sophisticated tool that allows users to model the performance of solar photovoltaic systems with great detail and accuracy. The latest update to the toolbox comes with additional features to broaden its capabilities. This document is a user manual which extensively explains the inputs required to model solar PV performance and the respective outputs.</p>
<p>Within this chapter, <a class="reference internal" href="#section-workflow"><span class="std std-ref">1.1 Workflow Diagram</span></a> depicts the workflow adopted to perform the calculations, <a class="reference internal" href="#section-inputs"><span class="std std-ref">1.2 Input Variable</span></a> explains the input variable, while the output variables from each computation are illustrated in <a class="reference internal" href="#section-outputs"><span class="std std-ref">1.3 Output Variables</span></a>.</p>
<p>The toolbox includes the following sub-functions:</p>
<ol class="arabic simple">
<li><p>CELL - Compute and evaluate the performance of interested solar cell chemistry</p></li>
<li><p>MODULE - Calculate and visualize the optical performance of defined PV system</p></li>
<li><p>WEATHER - Determine the amount of energy absorbed by the solar cells before electrical conversion</p></li>
<li><p>THERMAL - Calculate the operational temperatures of the PV system</p></li>
<li><p>ELECTRIC - Compute the DC Energy output from the defined PV system</p></li>
<li><p>DEGRADATION - Enumerate degradation performance of chosen solar cell and PV system</p></li>
<li><p>CONVERSION - Compute the AC Energy output of the PV system for chosen inverter</p></li>
<li><p>FINANCIALS - Determine and visualize the Levelised Cost of Electricity (LCOE) of defined system</p></li>
</ol>
<p>The functions are performed in the order specified in the aforementioned list whilst running the toolbox. Depending on the type of calculation, some of the sub-functions will be performed within other sub-functions or skipped entirely. This will be explained using a workflow diagram in this chapter. Moreover, the different possibilities of computations within the toolbox and the nature of the corresponding output variables will be defined in the later chapters of this user manual. The directory in which the sub-folders are stored looks like the one in <a class="reference internal" href="#fig-toolbox-dir"><span class="std std-numref">Fig. 1</span></a>, where each subfolder performs the function corresponding to its name. The other functions which are used will be explained in <a class="reference internal" href="#chapter-use-tb"><span class="std std-ref">3. PVMD toolbox usage</span></a>.</p>
<figure class="align-default" id="fig-toolbox-dir">
<a class="reference internal image-reference" href="../_images/toolbox_directory.png"><img alt="../_images/toolbox_directory.png" src="../_images/toolbox_directory.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">The PVMD toolbox directory.</span><a class="headerlink" href="#fig-toolbox-dir" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<section id="workflow-diagram">
<span id="section-workflow"></span><h3>1.1 Workflow Diagram<a class="headerlink" href="#workflow-diagram" title="Permalink to this headline">#</a></h3>
<p>In this section, the general workflow diagram on how data flows between the various sections of the toolbox is presented. This is applicable for all use cases and also illustrates how functions are by-passed/run differently based on the nature of inputs. The workflow diagram associated with this version of the toolbox has been provided in <a class="reference internal" href="#fig-workflow"><span class="std std-numref">Fig. 2</span></a>.</p>
<figure class="align-default" id="fig-workflow">
<img alt="../_images/workflow_diagram.png" src="../_images/workflow_diagram.png" />
<figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">The PVMD toolbox workflow diagram.</span><a class="headerlink" href="#fig-workflow" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In this workflow diagram, the rectangular blue containers represent the models that have been implemented in the PVMD Toolbox, while the green parallelogram containers represent the intermediate outputs. The workflow starts from the left hand side with the cell simulations (top-left), while the final and main outputs of the toolbox are the ones present in the circles on the right hand side of the diagram. The external/user inputs to the toolbox are represented using text (in black) present outside each computational step. Every time a user uses the toolbox, the outputs are determined based on this workflow.</p>
</section>
<section id="input-variable">
<span id="section-inputs"></span><h3>1.2 Input Variable<a class="headerlink" href="#input-variable" title="Permalink to this headline">#</a></h3>
<p>The input variable used in the calculations is called <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code>. This variable includes all user inputs and the respective paths of the files input while running the toolbox. The data stored in this variable is shown in <a class="reference internal" href="#fig-inputs"><span class="std std-numref">Fig. 3</span></a>.</p>
<figure class="align-default" id="fig-inputs">
<a class="reference internal image-reference" href="../_images/variables_inputs.png"><img alt="../_images/variables_inputs.png" src="../_images/variables_inputs.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">TOOLBOX inputs.</span><a class="headerlink" href="#fig-inputs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Within this dataset, every logical variable (such as <code class="docutils literal notranslate"><span class="pre">script</span></code> and <code class="docutils literal notranslate"><span class="pre">runModulePart</span></code>) is added to the dataset when the corresponding function is run in the toolbox. All the other variables contain the user-input data for each section of the toolbox and these variables will be explained in detail in <a class="reference internal" href="#chapter-use-tb"><span class="std std-ref">3. PVMD toolbox usage</span></a>. Some variables in this dataset have the value of <em>Not a Number</em> (<code class="docutils literal notranslate"><span class="pre">NaN</span></code>), and this means those functions do not produce any outputs due to the nature of user inputs. Such cases will also be included in <a class="reference internal" href="#chapter-use-tb"><span class="std std-ref">3. PVMD toolbox usage</span></a>.</p>
</section>
<section id="output-variables">
<span id="section-outputs"></span><h3>1.3 Output Variables<a class="headerlink" href="#output-variables" title="Permalink to this headline">#</a></h3>
<p>The outputs from the simulations always follow the format <code class="docutils literal notranslate"><span class="pre">FUNCTION_output</span></code>, where FUNCTION denotes the function performed using the toolbox. After performing all the operations, variables are stored in the base workspace in MATLAB as shown in <a class="reference internal" href="#fig-outputs"><span class="std std-numref">Fig. 4</span></a>.</p>
<figure class="align-default" id="fig-outputs">
<a class="reference internal image-reference" href="../_images/variables_output.png"><img alt="../_images/variables_output.png" src="../_images/variables_output.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 4 </span><span class="caption-text">Output variables.</span><a class="headerlink" href="#fig-outputs" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The variables stored within each output structure will be explained in <a class="reference internal" href="#chapter-use-tb"><span class="std std-ref">3. PVMD toolbox usage</span></a>.</p>
</section>
</section>
<section id="software-pre-requisites">
<span id="chapter-requisites"></span><h2>2. Software pre-requisites<a class="headerlink" href="#software-pre-requisites" title="Permalink to this headline">#</a></h2>
<p>The new version of the PVMD toolbox requires additional software to run the newly added features. Care is to be taken to remember that not all software from this list is necessary, but they can be included as a part of the user’s work package in order to run all possible functions in the toolbox.</p>
<section id="matlab">
<h3>2.1 Matlab<a class="headerlink" href="#matlab" title="Permalink to this headline">#</a></h3>
<p>As already mentioned, the PVMD toolbox has been almost entirely created on the MATLAB software. Some sections require add-ons to the basic MATLAB version. These add-ons are:</p>
<ul class="simple">
<li><p>Parallel computing toolbox add-on. This software is required for cell and module simulations when no previous results are loaded.</p></li>
<li><p>Mapping toolbox add-on. This software is required if the horizon is to be recalculated from height map files.</p></li>
<li><p>Optimization toolbox. This software is required for the electric simulations.</p></li>
</ul>
</section>
<section id="asa">
<span id="section-asa"></span><h3>2.2 ASA<a class="headerlink" href="#asa" title="Permalink to this headline">#</a></h3>
<p>The Advanced Semiconductor Analysis (ASA) simulator is a web-browser based software from TU Delft which is used for simulating the opto-electrical performance of solar cells quickly and efficiently <a class="footnote-reference brackets" href="#id13" id="id1">1</a>.</p>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark</p>
<p>This software is not necessary to run all the functions in the toolbox and only needed if the user would like to model the opto-electrical performance of another solar cell in detail.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>ASA is a paid software. Free trial is available on request.</p>
<p>In order to obtain ASA, visit its <a class="reference external" href="https://asa.ewi.tudelft.nl">website</a>. To understand ASA better or to improve the software, please visit the <a class="reference external" href="https://www.tudelft.nl/ewi/over-de-faculteit/afdelingen/electrical-sustainable-energy/photovoltaic-materials-and-devices/software-platform/asa-software">forum</a>.</p>
</div>
</section>
<section id="radiance">
<h3>2.3 Radiance<a class="headerlink" href="#radiance" title="Permalink to this headline">#</a></h3>
<p>Radiance is a visual rendering tool which allows users to perform lighting and optical simulations using advanced techniques such as ray-tracing <a class="footnote-reference brackets" href="#id14" id="id2">2</a>. This software is needed as a part of the toolbox to perform backward ray-tracing simulations involving very large files and complex geometric scenes, such as the ones encountered in non-periodic simulations.</p>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark</p>
<p>Radiance needs to be installed only if non-periodic simulations are to be run.</p>
</div>
<p>In this section, the installation procedure for Radiance will be explained for different OS platforms. To learn more about the other capabilities of Radiance, visit its <a class="reference external" href="https://www.radiance-online.org">website</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For more information on Radiance, visit the <a class="reference external" href="https://discourse.radiance-online.org/">forum</a></p>
</div>
<section id="installation-in-mac-os">
<h4>2.3.1 Installation in Mac-OS<a class="headerlink" href="#installation-in-mac-os" title="Permalink to this headline">#</a></h4>
<p>To maximise user ease while using Radiance on Mac-Os, XQuartz (X11) can be installed as an add-on with Radiance. It is a compiler similar to the command prompt application <code class="docutils literal notranslate"><span class="pre">Terminal</span></code>, but includes additional features specific to Radiance to maximise ease of use. It is preferred to use XQuartz instead of the actual command prompt to perform the commands of Radiance.</p>
<p>To install XQuartz, follow the steps:</p>
<ul class="simple">
<li><p>Download the latest version of <a class="reference external" href="www.xquartz.org">XQuartz</a>.</p></li>
<li><p>Run the disk image as the administrator and follow the instructions in the prompt to install XQuartz on the Mac-OS system.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This software is not necessary but can be used for exploring other Radiance functions used outside the PVMD Toolbox.</p>
</div>
<p>To obtain the latest package of Radiance, go to its <a class="reference external" href="www.radiance-online.org">website</a> and in the downloads tab one can install the software. This will redirect the user to the Github releases page. There are two files available, one is an installer with the extension <em>.pkg</em> and the other is a <em>.zip</em> file. Select the file with the <em>.pkg</em> extension, and follow the installation steps on prompt to complete installation.</p>
<p>After completing installation, it is important to add the environment variables (paths) to the shell. To do this, open the command prompt and type <code class="docutils literal notranslate"><span class="pre">nano.bash_profile</span></code>. Within the pop-up window, copy and paste the following commands:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export PATH=\$PATH:.:/usr/local/radiance/bin
export RAYPATH=.:/usr/local/radiance/lib
export MANPATH=\$MANPATH:/usr/local/radiance/man
export MDIR=/usr/local/lib/ray/meta/
</pre></div>
</div>
<figure class="align-default" id="fig-radiance-shell">
<a class="reference internal image-reference" href="../_images/radiance_add_variables_shell.png"><img alt="../_images/radiance_add_variables_shell.png" src="../_images/radiance_add_variables_shell.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 5 </span><span class="caption-text">Adding environment variables to the shell.</span><a class="headerlink" href="#fig-radiance-shell" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The command prompt looks like <a class="reference internal" href="#fig-radiance-shell"><span class="std std-numref">Fig. 5</span></a>, with the commands of interest highlighted in the red box. If the default shell is not bash, replace bash with name of the default shell being used in the system.</p>
<p>Finally, download the file <a class="reference external" href="http://www.radiance-online.org/cgi-bin/viewcvs.cgi/ray/lib/meta/vchars.mta?hideattic=0&amp;revision=1.2&amp;view=markup">vchars.mta</a>. Move this file to the directory <code class="docutils literal notranslate"><span class="pre">/usr/local/lib/ray/meta</span></code>.</p>
</section>
<section id="installation-in-windows">
<h4>2.3.2 Installation in Windows<a class="headerlink" href="#installation-in-windows" title="Permalink to this headline">#</a></h4>
<p>Windows users can directly install Radiance by downloading the <em>.exe</em> file from the <a class="reference external" href="https://floyd.lbl.gov/radiance/framed.html">downloads page</a> of the Radiance <a class="reference external" href="www.radiance-online.org">website</a>. In the installation page, download the file with the <em>.exe</em> extension and run the file. Follow the instructions on the prompt to complete installation. Install and save the Radiance files in the directory <code class="docutils literal notranslate"><span class="pre">C:\\Radiance</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To verify if the installation was completed successfully, use the command <code class="docutils literal notranslate"><span class="pre">man</span></code> in the system command prompt to see if the files are installed properly. You can also use the command <code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">\$RAYPATH</span></code> to check if the directory is correct. If any one of these commands generate an error, the installation was not completed correctly.</p>
</div>
</section>
<section id="adapt-the-path">
<h4>2.3.3 Adapt the path<a class="headerlink" href="#adapt-the-path" title="Permalink to this headline">#</a></h4>
<p>After installing Radiance, it is important to store this path as a variable in the MATLAB directory where the PVMD Toolbox is stored. In order to do this, perform the following steps:</p>
<ul class="simple">
<li><p>Open folder 2_MODULE/Non-Periodic/Inputs.</p></li>
<li><p>Load the file <em>radiancepath.mat</em> in MATLAB.</p></li>
<li><p>Re-write the data stored in this variable as:</p>
<ul>
<li><p>For Mac-OS systems: <code class="docutils literal notranslate"><span class="pre">/Users/username</span></code> where <em>username</em> is the user of the PC</p></li>
<li><p>For Windows systems: <code class="docutils literal notranslate"><span class="pre">C:\\Radiance\\bin</span></code></p></li>
</ul>
</li>
</ul>
<p>If another directory is used, change the name of the variable stored in <em>radiancepath.mat</em> accordingly.</p>
</section>
</section>
<section id="rhino-3d">
<h3>2.4 Rhino 3D<a class="headerlink" href="#rhino-3d" title="Permalink to this headline">#</a></h3>
<p>RHINOCEROS, or Rhino in short, is a 3D CAD package which is required as a pre-processing software to download and export 3D files for use in non-periodic simulations.</p>
<div class="admonition-remark admonition">
<p class="admonition-title">Remark</p>
<p>This software is not necessary to run all the functions in the toolbox and only needed in order to export 3D objects into the toolbox for non-periodic simulations. It is not important to know how Rhino works, but certain commands that allow the user to successfully export external geometries into the MATLAB environment.</p>
</div>
<p>In order to install Rhino, perform the following steps:</p>
<ul class="simple">
<li><p>Go to <a class="reference external" href="http://software.tudelft.nl">software.tudelft.nl</a></p></li>
<li><p>Login with Net-ID</p></li>
<li><p>Click on the latest version of Rhinoceros from the list of available softwares on the screen</p></li>
<li><p>Download the installation manual and the installation file from the pop-up window as shown in <a class="reference internal" href="#fig-rhino-installation"><span class="std std-numref">Fig. 6</span></a> for the corresponding OS platform</p></li>
<li><p>Follow the procedure in the manual to complete the installation</p></li>
</ul>
<figure class="align-default" id="fig-rhino-installation">
<a class="reference internal image-reference" href="../_images/rhino_installation.png"><img alt="../_images/rhino_installation.png" src="../_images/rhino_installation.png" style="width: 500px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 6 </span><span class="caption-text">Installation of Rhinoceros.</span><a class="headerlink" href="#fig-rhino-installation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Instead of Rhino, other CAD packages such as Blender or Autodesk can also be installed for the same purpose based on the user’s own experience with CAD packages. Rhino is only recommend as its licence is freely provided by TU Delft for students and employees alike.</p>
</div>
<section id="before-running-the-toolbox">
<span id="subsection-units-tb"></span><h4>2.4.1 Before running the toolbox<a class="headerlink" href="#before-running-the-toolbox" title="Permalink to this headline">#</a></h4>
<p>Before running non-periodic simulations on MATLAB with a new 3D object, it is important to convert the file into the appropriate format.</p>
<ul>
<li><p>If the file was designed by the user on a CAD package:</p>
<p>Use command Export/Save As to convert the 3D object into the format <em>.obj</em> (wavefront object file) and store it in the folder /Non-periodic simulations/3D files within the TOOLBOX</p>
</li>
<li><p>If the file is to be obtained externally:</p>
<p>This is an example workflow for obtaining 3D objects from the open-source 3D object library 3D Warehouse, from Google SketchUP. Export the SketchUP file in the format <em>.skp</em> and open it on Rhino. Once the file has been opened, export it to the <em>.obj</em> format. This is the recommended step for new users of the toolbox.</p>
<p>If some other CAD package is used or some other source was used to design/obtain the 3D geometry, ensure that the files can be imported into the user’s preferred CAD environment and exported as a <em>.obj</em> file for use in the toolbox.</p>
</li>
</ul>
<p>A few steps are to be followed before exporting the geometry in the required format:</p>
<ol class="arabic simple">
<li><p>Open the geometry file on Rhino</p></li>
<li><p>Select the entire object and run the command <code class="docutils literal notranslate"><span class="pre">MESH</span></code> (<a class="reference internal" href="#fig-rhino-meshing"><span class="std std-numref">Fig. 7</span></a>)</p></li>
<li><p>Once the previous step is complete, select the entire object once again and run the command <code class="docutils literal notranslate"><span class="pre">QUADRANGULATEMESH</span></code> (<a class="reference internal" href="#fig-rhino-remeshing"><span class="std std-numref">Fig. 8</span></a>)</p></li>
<li><p>Once the previous step is complete, export the geometry file in order to use it in the toolbox</p></li>
</ol>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-rhino-meshing">
<img alt="../_images/rhino_meshing_surfaces.png" src="../_images/rhino_meshing_surfaces.png" />
<figcaption>
<p><span class="caption-number">Fig. 7 </span><span class="caption-text">Meshing of un-meshed surfaces using <code class="docutils literal notranslate"><span class="pre">MESH</span></code> command</span><a class="headerlink" href="#fig-rhino-meshing" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-rhino-remeshing">
<img alt="../_images/rhino_quadrangulatemesh.png" src="../_images/rhino_quadrangulatemesh.png" />
<figcaption>
<p><span class="caption-number">Fig. 8 </span><span class="caption-text">Surfaces re-meshing using <code class="docutils literal notranslate"><span class="pre">QUADRANGULATEMESH</span></code> command</span><a class="headerlink" href="#fig-rhino-remeshing" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>Once these steps have been performed, remember to note the units down, as this data is important to include the panels in the scene. Only four units are accepted by the toolbox: <em>metres, inches, centimetres and millimetres</em>. If objects with other units are used, it will lead to errors in the scene. Care must be taken to ensure this, especially for objects obtained from external 3D libraries.</p>
<p>On exporting, two files are produced: the first is the <em>.obj</em> file, which includes geometric information, and the second is the <em>.mtl</em> file, which includes the material information. Both these files are used to load the 3d object and the procedure to do so will be explained in Chapter 3 of this manual.</p>
</section>
</section>
</section>
<section id="pvmd-toolbox-usage">
<span id="chapter-use-tb"></span><h2>3. PVMD toolbox usage<a class="headerlink" href="#pvmd-toolbox-usage" title="Permalink to this headline">#</a></h2>
<p>The PVMD Toolbox has two possible user workflows: one is using the interactive GUI in which each step involves the use of one or more sub-functions, or using the script version of the toolbox, where the entire toolbox is run at once. In this chapter, these two workflows will be illustrated in detail, along with the inputs that are used to perform the calculations.</p>
<section id="the-gui-version">
<h3>3.1 The GUI Version<a class="headerlink" href="#the-gui-version" title="Permalink to this headline">#</a></h3>
<p>To open the GUI version, run the file in the directory named <code class="docutils literal notranslate"><span class="pre">GUI_PVMDTOOLBOX.m</span></code>. This file also includes an explanation of what each function is in the comments of this file. Once you run the file, the GUI opens, which is shown in <a class="reference internal" href="#fig-gui-main"><span class="std std-numref">Fig. 9</span></a>.</p>
<figure class="align-default" id="fig-gui-main">
<a class="reference internal image-reference" href="../_images/gui_main_window.png"><img alt="../_images/gui_main_window.png" src="../_images/gui_main_window.png" style="width: 200px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 9 </span><span class="caption-text">The Toolbox GUI.</span><a class="headerlink" href="#fig-gui-main" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Once the GUI opens, the only variable present in the workspace will be <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code>, within which the only value stored will be the value <code class="docutils literal notranslate"><span class="pre">script</span></code>, whose value will be <code class="docutils literal notranslate"><span class="pre">false</span></code>. This is shown in <a class="reference internal" href="#fig-gui-opened"><span class="std std-numref">Fig. 10</span></a>.</p>
<figure class="align-default" id="fig-gui-opened">
<a class="reference internal image-reference" href="../_images/input_gui_opened.png"><img alt="../_images/input_gui_opened.png" src="../_images/input_gui_opened.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 10 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> when GUI is opened.</span><a class="headerlink" href="#fig-gui-opened" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>In the following subsections, the procedure to provide user inputs for each subsection and how these values are stored in the variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> will be explained.</p>
<section id="cell">
<h4>3.1.1 Cell<a class="headerlink" href="#cell" title="Permalink to this headline">#</a></h4>
<ol class="arabic simple">
<li><p>Click on the CELL button in the GUI to start the cell level.</p></li>
<li><p>A dialog box pops up, as shown in <a class="reference internal" href="#fig-cell-modelling-choice"><span class="std std-numref">Fig. 11</span></a>, where a saved simulation can be opened or a simulation can be run.</p></li>
</ol>
<figure class="align-default" id="fig-cell-modelling-choice">
<a class="reference internal image-reference" href="../_images/cell_modelling_choice.png"><img alt="../_images/cell_modelling_choice.png" src="../_images/cell_modelling_choice.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Choose Modelling option - CELL.</span><a class="headerlink" href="#fig-cell-modelling-choice" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Load saved simulation is selected:</em></p>
<ol class="arabic simple" start="3">
<li><p>Choose the saved file to load the output variable <code class="docutils literal notranslate"><span class="pre">CELL_output</span></code> into the workspace. This is shown in <a class="reference internal" href="#fig-cell-load-simulations"><span class="std std-numref">Fig. 12</span></a>, where there is currently only one saved simulation corresponding to a mono PERC module.</p></li>
</ol>
<figure class="align-default" id="fig-cell-load-simulations">
<a class="reference internal image-reference" href="../_images/cell_load_simulations.png"><img alt="../_images/cell_load_simulations.png" src="../_images/cell_load_simulations.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 12 </span><span class="caption-text">Load saved simulation - CELL.</span><a class="headerlink" href="#fig-cell-load-simulations" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Run GenPro4 is selected:</em></p>
<ol class="arabic simple" start="3">
<li><p>Choose the solar cell type on which the simulations are to be performed, as displayed in <a class="reference internal" href="#fig-cell-genpro-simulation"><span class="std std-numref">Fig. 13</span></a>. For more information on GenPRO, refer to the tutorial mentioned in <a class="footnote-reference brackets" href="#id15" id="id3">3</a>.</p></li>
</ol>
<figure class="align-default" id="fig-cell-genpro-simulation">
<a class="reference internal image-reference" href="../_images/cell_genpro_simulation.png"><img alt="../_images/cell_genpro_simulation.png" src="../_images/cell_genpro_simulation.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 13 </span><span class="caption-text">Run new GenPRO simulation - CELL.</span><a class="headerlink" href="#fig-cell-genpro-simulation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This starts running a new simulation and will take a few minutes to complete and outputs the variable <cite>CELL_output</cite>. Once completed, three plots are produced: two height maps of the cell and one plot displaying the cell’s absorptivity as a function of the angle of incidence of light. Sample figures have been provided in this manual via <a class="reference internal" href="#fig-cell-height-map"><span class="std std-numref">Fig. 14</span></a> and  <a class="reference internal" href="#fig-cell-absorptivity-plot"><span class="std std-numref">Fig. 15</span></a>.</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-cell-height-map">
<img alt="../_images/cell_height_map.png" src="../_images/cell_height_map.png" />
<figcaption>
<p><span class="caption-number">Fig. 14 </span><span class="caption-text">Height map plot resulting from GenPRO simulation.</span><a class="headerlink" href="#fig-cell-height-map" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-cell-absorptivity-plot">
<img alt="../_images/cell_absorptivity_plot.png" src="../_images/cell_absorptivity_plot.png" />
<figcaption>
<p><span class="caption-number">Fig. 15 </span><span class="caption-text">Cell absorptivity plot resulting from GenPRO simulation.</span><a class="headerlink" href="#fig-cell-absorptivity-plot" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>This new variable includes a logical value to show if GenPro was used or not, while the second variable stores the user selected file for the simulations. If a saved simulation was loaded, then the logical value in <a class="reference internal" href="#fig-input-after-cell"><span class="std std-numref">Fig. 16</span></a> will be stored as <code class="docutils literal notranslate"><span class="pre">false</span></code>.</p>
<figure class="align-default" id="fig-input-after-cell">
<a class="reference internal image-reference" href="../_images/input_after_cell.png"><img alt="../_images/input_after_cell.png" src="../_images/input_after_cell.png" style="width: 80%;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 16 </span><span class="caption-text">TOOLBOX_input after CELL simulations.</span><a class="headerlink" href="#fig-input-after-cell" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The <code class="docutils literal notranslate"><span class="pre">CELL_output</span></code> variable holds the normalised absorptance, reflection and transmitted irradiance values at a cell level. Within this variable, the values are stored as a field in the structure, as shown in <a class="reference internal" href="#fig-cell-output"><span class="std std-numref">Fig. 17</span></a>.</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-cell-output">
<img alt="../_images/cell_output.png" src="../_images/cell_output.png" />
<figcaption>
<p><span class="caption-number">Fig. 17 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">CELL_output</span></code> variable.</span><a class="headerlink" href="#fig-cell-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-cell-output-cell-front">
<img alt="../_images/cell_output_cell_front.png" src="../_images/cell_output_cell_front.png" />
<figcaption>
<p><span class="caption-number">Fig. 18 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">CELL_FRONT</span></code> values stored inside <code class="docutils literal notranslate"><span class="pre">CELL_output</span></code> variable.</span><a class="headerlink" href="#fig-cell-output-cell-front" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>Every cell simulation includes these three values: the optical performance of the front side of the cell, the optical performance of the rear side and the cell type. To define the optical performance of the cell, a snippet of the variable <code class="docutils literal notranslate"><span class="pre">CELL_FRONT</span></code> is shown in <a class="reference internal" href="#fig-cell-output-cell-front"><span class="std std-numref">Fig. 18</span></a>. This variable has the values of reflectance, absorptance and transmittance <code class="docutils literal notranslate"><span class="pre">RAT</span></code> as a function of wavelength <code class="docutils literal notranslate"><span class="pre">wav</span></code> and angle of incidence <code class="docutils literal notranslate"><span class="pre">aoi</span></code>. It also includes the layer definitions of the cell <code class="docutils literal notranslate"><span class="pre">lay</span></code> and the photocurrent values of the cell <code class="docutils literal notranslate"><span class="pre">Jph</span></code>. For bifacial cells, the variable <code class="docutils literal notranslate"><span class="pre">CELL_REAR</span></code> will be similar to <code class="docutils literal notranslate"><span class="pre">CELL_FRONT</span></code>.</p>
</section>
<section id="module">
<h4>3.1.2 Module<a class="headerlink" href="#module" title="Permalink to this headline">#</a></h4>
<p>To run the module level simulations, click the button MODULE in the GUI. This will open another GUI with two modelling options: Periodic and Non-periodic. In a periodic simulation, all the panels will have the same properties (such as incident energy, operating temperatures, etc.) while in non-periodic simulations these properties will vary from panel to panel.</p>
<section id="periodic-simulation">
<h5>3.1.2.1 Periodic Simulation<a class="headerlink" href="#periodic-simulation" title="Permalink to this headline">#</a></h5>
<ol class="arabic simple">
<li><p>On clicking the PERIODIC button, a dialog box similar to CELL opens: A user can load a saved simulation or run a new one.</p></li>
</ol>
<p><em>If Load saved simulation is chosen:</em></p>
<ol class="arabic simple" start="2">
<li><p>Choose the cell technology similar to CELL module (refer to <a class="reference internal" href="#fig-cell-load-simulations"><span class="std std-numref">Fig. 12</span></a>)</p></li>
<li><p>Define the module mounting properties. This will output the variable <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> (<a class="reference internal" href="#fig-module-mounting-properties"><span class="std std-numref">Fig. 19</span></a>). This data will be used for the irradiance and temperature calculations.</p></li>
</ol>
<figure class="align-default" id="fig-module-mounting-properties">
<a class="reference internal image-reference" href="../_images/module_mounting_properties.png"><img alt="../_images/module_mounting_properties.png" src="../_images/module_mounting_properties.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 19 </span><span class="caption-text">Define module mounting properties.</span><a class="headerlink" href="#fig-module-mounting-properties" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Perform ray tracing is chosen:</em></p>
<ol class="arabic simple" start="2">
<li><p>Define the module and ground properties as shown in <a class="reference internal" href="#fig-module-properties"><span class="std std-numref">Fig. 20</span></a>. The module which will be used for the simulations will be displayed as in <a class="reference internal" href="#fig-module-scenario"><span class="std std-numref">Fig. 21</span></a>.</p></li>
</ol>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-module-properties">
<a class="reference internal image-reference" href="../_images/module_properties.png"><img alt="../_images/module_properties.png" src="../_images/module_properties.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 20 </span><span class="caption-text">Window to define the module properties.</span><a class="headerlink" href="#fig-module-properties" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-module-scenario">
<img alt="../_images/module_scenario.png" src="../_images/module_scenario.png" />
<figcaption>
<p><span class="caption-number">Fig. 21 </span><span class="caption-text">Scenario of the module used for the ray-tracing simulations.</span><a class="headerlink" href="#fig-module-scenario" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<ol class="arabic simple" start="3">
<li><p>Define the number of rays used for the ray-tracing simulation in the pop-up window that will appear.</p></li>
<li><p>Define the type of sensitivity in the module by choosing between average or individual cell sensitivity.</p></li>
</ol>
<p>Once the simulations are completed, the variable <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> will be produced in the workspace. During the simulations, the sensitivity map <a class="footnote-reference brackets" href="#id16" id="id4">4</a> and the progress of the ray-tracing will be displayed as shown in <a class="reference internal" href="#fig-module-ray-tracing"><span class="std std-numref">Fig. 22</span></a> and  <a class="reference internal" href="#fig-module-sensitivity-map"><span class="std std-numref">Fig. 23</span></a>.</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-module-ray-tracing">
<img alt="../_images/module_ray_tracing.png" src="../_images/module_ray_tracing.png" />
<figcaption>
<p><span class="caption-number">Fig. 22 </span><span class="caption-text">The progress of the ray-tracing simulations is shown with the change in scenario.</span><a class="headerlink" href="#fig-module-ray-tracing" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-module-sensitivity-map">
<img alt="../_images/module_sensitivity_map.png" src="../_images/module_sensitivity_map.png" />
<figcaption>
<p><span class="caption-number">Fig. 23 </span><span class="caption-text">The progress of the ray-tracing simulations is shown with the change in sensitivity map.</span><a class="headerlink" href="#fig-module-sensitivity-map" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The modifications in the variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> and the values stored in the variable <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> will be explained in <a class="reference internal" href="#subsection-module-output"><span class="std std-ref">3.1.2.3 Output variable</span></a>.</p>
</section>
<section id="non-periodic-simulation">
<span id="subsection-module-non-per"></span><h5>3.1.2.2 Non-periodic Simulation<a class="headerlink" href="#non-periodic-simulation" title="Permalink to this headline">#</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a non-periodic simulation is run, WEATHER part is skipped.</p>
</div>
<p>On clicking the NON-PERIODIC button, a dialog box pops up requesting the user to load existing results or to run a new simulation. Choosing option 1 (load existing results) will directly output the variables <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> and <code class="docutils literal notranslate"><span class="pre">WEATHER_output</span></code>.</p>
<p>On running a new simulation, another GUI pops up to perform the various sub-tasks for non-periodic simulations (<a class="reference internal" href="#fig-module-non-periodic-gui"><span class="std std-numref">Fig. 24</span></a>).</p>
<figure class="align-default" id="fig-module-non-periodic-gui">
<a class="reference internal image-reference" href="../_images/module_non_periodic_gui.png"><img alt="../_images/module_non_periodic_gui.png" src="../_images/module_non_periodic_gui.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 24 </span><span class="caption-text">GUI for running non-periodic simulations.</span><a class="headerlink" href="#fig-module-non-periodic-gui" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple">
<li><p>Load 3D object: Select the first button to load a 3D object. Again this gives two possibilities:</p></li>
</ol>
<p><em>If load an existing 3D object is chosen</em></p>
<blockquote>
<div><p>Loading an existing file will directly load the data into the variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code>, as will be explained in the later part of this subsection. Move to step 3. Add PV Panels.</p>
</div></blockquote>
<p><em>If load a new object is chosen</em></p>
<blockquote>
<div><p>If a new 3D object is to be loaded, select option <em>Load New 3D Scene</em>. A prompt will appear asking to choose the material file of the object you wish to load with <em>.mtl</em> extension (see <a class="reference internal" href="#fig-module-material-choice"><span class="std std-numref">Fig. 25</span></a>). Once the material file is selected, a second dialog box will prompt to select the corresponding geometry file with <em>.obj</em> extension.</p>
</div></blockquote>
<figure class="align-default" id="fig-module-material-choice">
<a class="reference internal image-reference" href="../_images/module_material_choice.png"><img alt="../_images/module_material_choice.png" src="../_images/module_material_choice.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 25 </span><span class="caption-text">Choose the material file.</span><a class="headerlink" href="#fig-module-material-choice" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple" start="2">
<li><p>Refine Surfaces: This step ensures the geometry is refined to eliminate parsing errors.</p></li>
<li><p>Add PV Panels: Click on this step to add the panels. Similar to the first step in a non-periodic simulation, a dialog box appears with two options: Load existing scene with panels or add panels to new scene. The first option loads the variable <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> with the panel data from an existing dataset. Directly move to step 4. View Scene if the first option is selected.</p></li>
</ol>
<p>Once this button is clicked, a dialog box appears asking the user to input the units with which the 3D object was designed. In <a class="reference internal" href="#subsection-units-tb"><span class="std std-ref">2.4.1 Before running the toolbox</span></a>, it was explained how to note the units for externally obtained 3D objects. Enter the units with which the model was designed (<a class="reference internal" href="#fig-module-model-units"><span class="std std-numref">Fig. 26</span></a>).</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The units can be meters, inches, millimetres or centimetres only.</p>
</div>
<figure class="align-default" id="fig-module-model-units">
<a class="reference internal image-reference" href="../_images/module_model_units.png"><img alt="../_images/module_model_units.png" src="../_images/module_model_units.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 26 </span><span class="caption-text">Enter model units.</span><a class="headerlink" href="#fig-module-model-units" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Enter the azimuth of the loaded 3D object or scene when prompted.</p>
<p>Now, a dialog appears with two options: either the panels can be placed beside the scene, or on a surface of the 3D object.</p>
<p><em>If Place Modules beside 3D Object</em></p>
<blockquote>
<div><p>Define the geometric properties of the module when prompted (as shown in <a class="reference internal" href="#fig-module-properties"><span class="std std-numref">Fig. 20</span></a>).</p>
<p>Enter the distance (along both X &amp; Y axes) from the 3D geometry where the panels will be placed in the scene, as shown in <a class="reference internal" href="#fig-module-module-placement"><span class="std std-numref">Fig. 27</span></a>.</p>
</div></blockquote>
<figure class="align-default" id="fig-module-module-placement">
<a class="reference internal image-reference" href="../_images/module_module_placement.png"><img alt="../_images/module_module_placement.png" src="../_images/module_module_placement.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 27 </span><span class="caption-text">Define the distance to place panels.</span><a class="headerlink" href="#fig-module-module-placement" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Place Modules on a surface of the 3D Object</em>:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is not recommended as yet for complex scenes.</p>
<p>Select the points on the surface of interest on which the panels are to be placed (see <a class="reference internal" href="#fig-module-surface-selection"><span class="std std-numref">Fig. 28</span></a>). The selected points are shown with red dots.</p>
</div>
<figure class="align-default" id="fig-module-surface-selection">
<a class="reference internal image-reference" href="../_images/module_surface_selection.png"><img alt="../_images/module_surface_selection.png" src="../_images/module_surface_selection.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 28 </span><span class="caption-text">Select surface of interest to place panels.</span><a class="headerlink" href="#fig-module-surface-selection" title="Permalink to this image">#</a></p>
<div class="legend">
<p>Define the geometric properties of the modules when prompted (refer <a class="reference internal" href="#fig-module-properties"><span class="std std-numref">Fig. 20</span></a>). Enter the distance (along the selected surface) from the edges to place the panels on the surface (refer <a class="reference internal" href="#fig-module-module-placement"><span class="std std-numref">Fig. 27</span></a>).</p>
</div>
</figcaption>
</figure>
<ol class="arabic simple" start="4">
<li><p>View Scene: This option is used to view the loaded 3D object or defined scene. On clicking this button, a dialog box appears where the user can choose if only the 3D object is to be viewed or the entire scene. On clicking either of the options, the user can choose from another dialog box if a surface assigned to a certain material is to be viewed, or the entire scene (see <a class="reference internal" href="#fig-module-viewing-choice"><span class="std std-numref">Fig. 29</span></a>). A few possibilities have been shown in <a class="reference internal" href="#fig-module-view-object"><span class="std std-numref">Fig. 30</span></a> to <a class="reference internal" href="#fig-module-view-surface"><span class="std std-numref">Fig. 33</span></a>.</p></li>
</ol>
<figure class="align-default" id="fig-module-viewing-choice">
<a class="reference internal image-reference" href="../_images/module_viewing_choice.png"><img alt="../_images/module_viewing_choice.png" src="../_images/module_viewing_choice.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 29 </span><span class="caption-text">Choose surface/object to view.</span><a class="headerlink" href="#fig-module-viewing-choice" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<table class="table">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-module-view-object">
<img alt="../_images/module_view_object.png" src="../_images/module_view_object.png" />
<figcaption>
<p><span class="caption-number">Fig. 30 </span><span class="caption-text">Object view.</span><a class="headerlink" href="#fig-module-view-object" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-module-view-scene-1">
<img alt="../_images/module_view_scene_1.png" src="../_images/module_view_scene_1.png" />
<figcaption>
<p><span class="caption-number">Fig. 31 </span><span class="caption-text">Scene view.</span><a class="headerlink" href="#fig-module-view-scene-1" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-module-view-scene-2">
<img alt="../_images/module_view_scene_2.png" src="../_images/module_view_scene_2.png" />
<figcaption>
<p><span class="caption-number">Fig. 32 </span><span class="caption-text">Scene view.</span><a class="headerlink" href="#fig-module-view-scene-2" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-module-view-surface">
<img alt="../_images/module_view_surface.png" src="../_images/module_view_surface.png" />
<figcaption>
<p><span class="caption-number">Fig. 33 </span><span class="caption-text">Single surface view.</span><a class="headerlink" href="#fig-module-view-surface" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The user can also get information on the number of individual elements (polygons) constituting a surface and the total surface area count of the chosen surface or object.</p>
<ol class="arabic simple" start="5">
<li><p>Load Material Library: Click on this button to load the materials contained in the library used from <a class="reference external" href="https://ecostress.jpl.nasa.gov">NASA’s ECOSTRESS Library</a>, with the data modified for use in the PVMD Toolbox. The loaded material library on opening has three material reflectance values which are used in the ray-tracing simulations, as shown in <a class="reference internal" href="#fig-module-material-library"><span class="std std-numref">Fig. 34</span></a>.</p></li>
</ol>
<figure class="align-default" id="fig-module-material-library">
<a class="reference internal image-reference" href="../_images/module_material_library.png"><img alt="../_images/module_material_library.png" src="../_images/module_material_library.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 34 </span><span class="caption-text">Material Library.</span><a class="headerlink" href="#fig-module-material-library" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>5a. Update Material Library: Click on this button to make changes to the existing material property dataset. On clicking this button, the following pop-up appears:</p>
<figure class="align-default" id="id24">
<a class="reference internal image-reference" href="../_images/module_edit_material_library.png"><img alt="../_images/module_edit_material_library.png" src="../_images/module_edit_material_library.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 35 </span><span class="caption-text">Options to edit material library.</span><a class="headerlink" href="#id24" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Add Materials is chosen:</em></p>
<blockquote>
<div><p>Only add materials from the NASA ECOSTRESS Library. This option is not recommended as all materials are already present. Use only if a new version with additional material is available.</p>
<p>Choose the folder containing the files from the ECOSTRESS library you wish to include in the toolbox.</p>
</div></blockquote>
<p><em>If Remove Materials is chosen:</em></p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is used to permanently delete material data files. Use this only if redundancies in material data are observed (mostly for developers).</p>
<p>Select the materials from the list dialog box to remove the materials not required by the user.</p>
</div>
<figure class="align-default" id="fig-module-material-removal">
<a class="reference internal image-reference" href="../_images/module_material_removal.png"><img alt="../_images/module_material_removal.png" src="../_images/module_material_removal.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 36 </span><span class="caption-text">Remove materials from library.</span><a class="headerlink" href="#fig-module-material-removal" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Update Radiance Channel values is chosen</em>:</p>
<blockquote>
<div><p>The PVMD Toolbox uses the property <em>Spectrally Integrated Albedo</em> to determine the reflectance property of a material assigned to a surface. Use this option to update the limits used to find this value, as shown in <a class="reference internal" href="#fig-module-update-albedo"><span class="std std-numref">Fig. 37</span></a>.</p>
</div></blockquote>
<figure class="align-default" id="fig-module-update-albedo">
<a class="reference internal image-reference" href="../_images/module_update_albedo.png"><img alt="../_images/module_update_albedo.png" src="../_images/module_update_albedo.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 37 </span><span class="caption-text">Update the Spectrally Integrated Albedo.</span><a class="headerlink" href="#fig-module-update-albedo" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Refer to Appendix <a class="reference internal" href="#appendix-a"><span class="std std-ref">A. Information on material reflectances</span></a> for more information on Spectrally Integrated Albedo.</p>
<p>5b. View Material Reflectances: Click on this option to view the reflective properties of several materials in the toolbox. Once the user clicks this button, a dialog box similar to <a class="reference internal" href="#fig-module-material-removal"><span class="std std-numref">Fig. 36</span></a> appears, from which the user can make multiple selections to view the material properties for various materials. A snippet of the plot is shown below.</p>
<figure class="align-default" id="id25">
<a class="reference internal image-reference" href="../_images/module_plot_reflectivity.png"><img alt="../_images/module_plot_reflectivity.png" src="../_images/module_plot_reflectivity.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 38 </span><span class="caption-text">Material reflectivity plot.</span><a class="headerlink" href="#id25" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple" start="6">
<li><p>Assign Materials: This option is used to assign materials to the surfaces defining the 3D object. The material properties of the solar cells have already been defined during the CELL block, so the user does not have to define them again. On selecting this option, the user is presented with four options as shown in <a class="reference internal" href="#fig-module-material-assignation"><span class="std std-numref">Fig. 39</span></a>.</p></li>
</ol>
<figure class="align-default" id="fig-module-material-assignation">
<a class="reference internal image-reference" href="../_images/module_material_assignation.png"><img alt="../_images/module_material_assignation.png" src="../_images/module_material_assignation.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 39 </span><span class="caption-text">User Options to assign materials.</span><a class="headerlink" href="#fig-module-material-assignation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Load Existing Opto-Geometric Dataset is chosen:</em></p>
<blockquote>
<div><p>Data is directly loaded and stored in <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code>.</p>
</div></blockquote>
<p><em>If Assign data directly from *.mtl</em> file is chosen*:</p>
<blockquote>
<div><p>Material data is directly assigned to the surfaces and stored in <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code>. Enter the albedo of the ground when prompted.</p>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This option is not recommended as the reflective properties are incorrect. Refer to Appendix <a class="reference internal" href="#appendix-a"><span class="std std-ref">A. Information on material reflectances</span></a> for more information.</p>
</div>
<p><em>If Include Spectral data from ECOSTRESS Library is chosen:</em></p>
<blockquote>
<div><p>Enter the reflectivity of the ground when prompted. Select the surface to assign the material as shown in <a class="reference internal" href="#fig-module-surface-material"><span class="std std-numref">Fig. 40</span></a> (multiple selection possible). Once selected, a prompt with the same layout will appear to choose the material to be assigned to this surface.</p>
</div></blockquote>
<figure class="align-default" id="fig-module-surface-material">
<a class="reference internal image-reference" href="../_images/module_surface_material.png"><img alt="../_images/module_surface_material.png" src="../_images/module_surface_material.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 40 </span><span class="caption-text">Select surface of interest.</span><a class="headerlink" href="#fig-module-surface-material" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Assign the subclass to the surface as displayed in <a class="reference internal" href="#fig-module-assign-subclass"><span class="std std-numref">Fig. 41</span></a>, according to the property of the material (eg: if the chosen material is a metal, choose metal as subclass).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to Appendix <a class="reference internal" href="#appendix-b"><span class="std std-ref">B. Information on Radiance subclasses and testpoints</span></a> for information on subclass.</p>
</div>
<figure class="align-default" id="fig-module-assign-subclass">
<a class="reference internal image-reference" href="../_images/module_assign_subclass.png"><img alt="../_images/module_assign_subclass.png" src="../_images/module_assign_subclass.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 41 </span><span class="caption-text">Assign subclass to material.</span><a class="headerlink" href="#fig-module-assign-subclass" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Perform all previous steps to assign materials to all surfaces in the 3D geometry.</p>
<ol class="arabic simple" start="7">
<li><p>Convert Files to Radiance: Click on this option to convert the user defined scene into the Radiance format to perform the ray-tracing. During this process, the user is asked to enter the number of testpoints used in the ray-tracing. This stands for the number of grid points in a cell, being 4 the maximum.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to Appendix <a class="reference internal" href="#appendix-b"><span class="std std-ref">B. Information on Radiance subclasses and testpoints</span></a> for information on testpoints.</p>
</div>
<p>The path where the Radiance files will be stored will be explained later in this chapter.</p>
<ol class="arabic simple" start="8">
<li><p>Ray-trace: Click on this option to run the ray-tracing simulation. On clicking, the user is prompted to enter the timeframe of the simulation to be performed.</p></li>
</ol>
<figure class="align-default" id="id26">
<a class="reference internal image-reference" href="../_images/module_period_assignation.png"><img alt="../_images/module_period_assignation.png" src="../_images/module_period_assignation.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 42 </span><span class="caption-text">Enter period for the simulations.</span><a class="headerlink" href="#id26" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Select the climate file which has the weather data for the simulations as shown in :numref: <cite>fig-module_climate_selection</cite>.</p>
<figure class="align-default" id="fig-module-climate-selection">
<a class="reference internal image-reference" href="../_images/module_climate_selection.png"><img alt="../_images/module_climate_selection.png" src="../_images/module_climate_selection.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 43 </span><span class="caption-text">Select the climate file.</span><a class="headerlink" href="#fig-module-climate-selection" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>When prompted, write Yes <code class="docutils literal notranslate"><span class="pre">Y</span></code> or No <code class="docutils literal notranslate"><span class="pre">N</span></code> in the command window to include horizon reconstruction at chosen location.</p>
<p><em>If Yes is chosen:</em></p>
<blockquote>
<div><p>Enter the latitude and longitude of the location when prompted.</p>
</div></blockquote>
<figure class="align-default" id="id27">
<a class="reference internal image-reference" href="../_images/module_location_details.png"><img alt="../_images/module_location_details.png" src="../_images/module_location_details.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 44 </span><span class="caption-text">Enter location details.</span><a class="headerlink" href="#id27" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Again, when prompted, write Yes <code class="docutils literal notranslate"><span class="pre">Y</span></code> or No <code class="docutils literal notranslate"><span class="pre">N</span></code> in the command window to re-calculate the horizon parameters or to use an existing file.</p>
<p><em>Again, if Yes is chosen:</em></p>
<blockquote>
<div><p>Enter in the command window the radius of interest to be used to re-generate the horizon when prompted in the command window. When the pop-up appears, choose the LiDAR file <a class="footnote-reference brackets" href="#id17" id="id5">5</a> used to re-generate the horizon.</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to Appendix <a class="reference internal" href="#appendix-c"><span class="std std-ref">C. Downloading .tif files for horizon reconstruction</span></a> on how to download <em>.tif</em> files.</p>
</div>
<p>The ray-tracing is performed as soon as these inputs are provided.</p>
<ol class="arabic simple" start="9">
<li><p>View Results in the GUI. This presents three options:</p></li>
</ol>
<figure class="align-default" id="id28">
<a class="reference internal image-reference" href="../_images/module_view_choices.png"><img alt="../_images/module_view_choices.png" src="../_images/module_view_choices.png" style="width: 250px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 45 </span><span class="caption-text">Choices to view results.</span><a class="headerlink" href="#id28" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>View Results for a single time interval</em>: Enter the time instant at which the result is to be used. The format <code class="docutils literal notranslate"><span class="pre">DD-Mon</span> <span class="pre">HH:MM</span></code> such as in <code class="docutils literal notranslate"><span class="pre">04-Jan</span> <span class="pre">14:00</span></code> needs to be used. The result of a non-periodic simulation for a single time instant is illustrated below.</p>
<figure class="align-default" id="id29">
<a class="reference internal image-reference" href="../_images/module_single_time_results.png"><img alt="../_images/module_single_time_results.png" src="../_images/module_single_time_results.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 46 </span><span class="caption-text">Results for a single time instant.</span><a class="headerlink" href="#id29" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>View monthly results</em>: Enter the month for which the results are to be viewed in a similar format as previous option.</p>
<p><em>View results for a year</em>: Whole yearly period is selected.</p>
<p>Once the simulations are run, the variable <code class="docutils literal notranslate"><span class="pre">WEATHER_output</span></code> will also be created.</p>
</section>
<section id="output-variable">
<span id="subsection-module-output"></span><h5>3.1.2.3 Output variable<a class="headerlink" href="#output-variable" title="Permalink to this headline">#</a></h5>
<p><code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> houses the variables associated with the module level simulations in the toolbox. A snapshot of the variables is shown in Figure <a class="reference internal" href="#fig-module-output"><span class="std std-numref">Fig. 47</span></a>.</p>
<figure class="align-default" id="fig-module-output">
<a class="reference internal image-reference" href="../_images/module_output.png"><img alt="../_images/module_output.png" src="../_images/module_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 47 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code> variable.</span><a class="headerlink" href="#fig-module-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Within <code class="docutils literal notranslate"><span class="pre">MODULE_output</span></code>, the variable <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> defines if the modules are electrically reconfigurable or not. The skydome is used to determine the irradiance on the modules, along with the Sensitivity Map <code class="docutils literal notranslate"><span class="pre">SM-f</span></code> of the solar cells. The values <code class="docutils literal notranslate"><span class="pre">N</span></code>, <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">Amod</span></code> represent the number of cells, area of a cell and area of the module respectively. Finally, the module tilt is also stored in this struct. For non-periodic simulations, the values <code class="docutils literal notranslate"><span class="pre">SM-f</span></code>, <code class="docutils literal notranslate"><span class="pre">skydome</span></code> and <code class="docutils literal notranslate"><span class="pre">wav</span></code> are replaced by <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> is now updated with the user inputs for the module simulations:</p>
<figure class="align-default" id="id30">
<img alt="../_images/input_after_module.png" src="../_images/input_after_module.png" />
<figcaption>
<p><span class="caption-number">Fig. 48 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after MODULE.</span><a class="headerlink" href="#id30" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The variable now includes the fields which include the user inputs from MODULE simulations. The variable <code class="docutils literal notranslate"><span class="pre">runPeriodic</span></code> will be <code class="docutils literal notranslate"><span class="pre">true</span></code> if the periodic simulation was run in the toolbox. Moreover, the values from irradiation will be generated only in the WEATHER part for the periodic simulations and therefore will be discussed in next subsection.</p>
<p>Within the field <code class="docutils literal notranslate"><span class="pre">Scene</span></code>, the data related to the 3D geometry input into the toolbox and the geometric properties of the modules are stored. This also includes the opto-geometric data set (with materials assigned to the surfaces), the arrangement of the cells and modules in the scene and the path where the Radiance files are stored. This concludes the MODULE simulations and next comes WEATHER.</p>
</section>
</section>
<section id="weather">
<h4>3.1.3 Weather<a class="headerlink" href="#weather" title="Permalink to this headline">#</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Proceed to THERMAL directly if non-periodic simulation is performed, the WEATHER button on the GUI gets disabled on selection. The variable <code class="docutils literal notranslate"><span class="pre">WEATHER_output</span></code> is however explained in this section.</p>
</div>
<ol class="arabic simple">
<li><p>On starting the WEATHER simulations, the first thing that appears is a dialog box requesting the user to choose the location where the irradiance is to be calculated.</p></li>
</ol>
<figure class="align-default" id="id31">
<a class="reference internal image-reference" href="../_images/weather_location_choice.png"><img alt="../_images/weather_location_choice.png" src="../_images/weather_location_choice.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 49 </span><span class="caption-text">Choose weather location.</span><a class="headerlink" href="#id31" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple" start="2">
<li><p>When prompted, enter the timeframe for the simulation. The initial day and month as well as the final day and month for the simulations need to be provided. Months are expressed here with values between 1 and 12.</p></li>
<li><p>Choose from the pop-up menu whether to reconstruct the horizon or not. If yes is chosen, the user is once again prompted to enter the choice of using an existing data set or run a new calculation.</p></li>
</ol>
<p><em>If the horizon is to be reconstructed</em></p>
<blockquote>
<div><p>Enter the location and simulation details when prompted via a dialog box. The radius variable represents the area around the location to be used for the horizon reconstruction.</p>
</div></blockquote>
<figure class="align-default" id="id32">
<a class="reference internal image-reference" href="../_images/weather_horizon_details.png"><img alt="../_images/weather_horizon_details.png" src="../_images/weather_horizon_details.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 50 </span><span class="caption-text">Information required to reconstruct the horizon.</span><a class="headerlink" href="#id32" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The user is requested to select the LiDAR file in <em>.tif</em> extension <a class="footnote-reference brackets" href="#id17" id="id6">5</a> for the horizon calculations thereafter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Refer to Appendix <a class="reference internal" href="#appendix-c"><span class="std std-ref">C. Downloading .tif files for horizon reconstruction</span></a> on how to download <em>.tif</em> files.</p>
</div>
<p><a class="reference internal" href="#fig-weather-reconstructed-horizon"><span class="std std-numref">Fig. 51</span></a> below shows an example of a reconstructed horizon.</p>
<figure class="align-default" id="fig-weather-reconstructed-horizon">
<a class="reference internal image-reference" href="doc_images/weather_reconstructed_horizon.png"><img alt="doc_images/weather_reconstructed_horizon.png" src="doc_images/weather_reconstructed_horizon.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 51 </span><span class="caption-text">Example of the reconstructed horizon for the location in the markt of Delft.</span><a class="headerlink" href="#fig-weather-reconstructed-horizon" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This performs the weather calculations, and the sky map is displayed <a class="footnote-reference brackets" href="#id18" id="id7">6</a> <a class="footnote-reference brackets" href="#id19" id="id8">7</a> when the simulation is being performed. A snippet of the plot generated mid-calculation is shown below.</p>
<figure class="align-default" id="id33">
<a class="reference internal image-reference" href="../_images/weather_sky_map.png"><img alt="../_images/weather_sky_map.png" src="../_images/weather_sky_map.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 52 </span><span class="caption-text">Sky map during WEATHER simulations.</span><a class="headerlink" href="#id33" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Once the simulations are completed, the variable <code class="docutils literal notranslate"><span class="pre">WEATHER_output</span></code> is generated. It includes the data from the weather simulations, such as the module performance and other site related data. The data stored in this variable has been depicted in <a class="reference internal" href="#fig-weather-output"><span class="std std-numref">Fig. 53</span></a>.</p>
<figure class="align-default" id="fig-weather-output">
<a class="reference internal image-reference" href="../_images/weather_output.png"><img alt="../_images/weather_output.png" src="../_images/weather_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 53 </span><span class="caption-text">WEATHER_output variable.</span><a class="headerlink" href="#fig-weather-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The variables <code class="docutils literal notranslate"><span class="pre">A</span></code> and <code class="docutils literal notranslate"><span class="pre">J</span></code> contain the absorptance data and photocurrent for every cell at each time-step of the simulation. The variable <code class="docutils literal notranslate"><span class="pre">Period</span></code> signifies the period in time used for the simulations. The other datasets which are present include the global horizontal irradiance <code class="docutils literal notranslate"><span class="pre">Irr</span></code>, the ambient temperature and wind speed at the site. The variables <code class="docutils literal notranslate"><span class="pre">RH</span></code>, <code class="docutils literal notranslate"><span class="pre">UVa</span></code> and <code class="docutils literal notranslate"><span class="pre">UVb</span></code> are used during the degradation simulations to compute panel degradation performance. For non-periodic simulations, the values of absorptance and photocurrent are stored per module, in the form of a cell dataset and each cell denotes the properties for a single module.</p>
<p>The variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> gets updated as follows: A new field <code class="docutils literal notranslate"><span class="pre">irradiation</span></code> is included, which includes the data from the WEATHER simulations, such as the chosen location and climate file, duration of simulations and whether horizon data was included in the simulations. A snippet of the dataset is shown below.</p>
<figure class="align-default" id="id34">
<img alt="../_images/input_after_weather.png" src="../_images/input_after_weather.png" />
<figcaption>
<p><span class="caption-number">Fig. 54 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after WEATHER.</span><a class="headerlink" href="#id34" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="thermal">
<h4>3.1.4 Thermal<a class="headerlink" href="#thermal" title="Permalink to this headline">#</a></h4>
<p>The THERMAL block is used to calculate the cell temperatures during the desired frame of simulation <a class="footnote-reference brackets" href="#id20" id="id9">8</a>. On clicking the button, the user is asked to input the temperature coefficients of the cell and this is the only set of inputs used in the calculations. A picture of the prompt after the user clicks this button is shown in <a class="reference internal" href="#fig-thermal-user-input"><span class="std std-numref">Fig. 55</span></a>.</p>
<figure class="align-default" id="fig-thermal-user-input">
<a class="reference internal image-reference" href="../_images/thermal_user_input.png"><img alt="../_images/thermal_user_input.png" src="../_images/thermal_user_input.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 55 </span><span class="caption-text">User inputs for THERMAL.</span><a class="headerlink" href="#fig-thermal-user-input" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Once the thermal calculations are completed, the plots related to the simulations are generated: cell temperatures (<a class="reference internal" href="#fig-thermal-temperature"><span class="std std-numref">Fig. 56</span></a>), sunniest period (<a class="reference internal" href="#fig-thermal-sunniest-day"><span class="std std-numref">Fig. 57</span></a>) and irradiation plot (<a class="reference internal" href="#fig-thermal-irradiation"><span class="std std-numref">Fig. 58</span></a>). The plots which are generated for the non-periodic simulations will be a combination of subplots, with the same data for each module present in the scene.</p>
<table class="table">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-thermal-temperature">
<img alt="../_images/thermal_temperature.png" src="../_images/thermal_temperature.png" />
<figcaption>
<p><span class="caption-number">Fig. 56 </span><span class="caption-text">Module temperature plot.</span><a class="headerlink" href="#fig-thermal-temperature" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-thermal-sunniest-day">
<img alt="../_images/thermal_sunniest_day.png" src="../_images/thermal_sunniest_day.png" />
<figcaption>
<p><span class="caption-number">Fig. 57 </span><span class="caption-text">Sunniest day from selected period.</span><a class="headerlink" href="#fig-thermal-sunniest-day" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-thermal-irradiation">
<img alt="../_images/thermal_irradiation.png" src="../_images/thermal_irradiation.png" />
<figcaption>
<p><span class="caption-number">Fig. 58 </span><span class="caption-text">Daily irradiation plot.</span><a class="headerlink" href="#fig-thermal-irradiation" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The output variable <code class="docutils literal notranslate"><span class="pre">THERMAL_output</span></code> stores the temperatures of each cell during each time-step of the simulation in sub-variable <code class="docutils literal notranslate"><span class="pre">T</span></code>. Again, this variable is converted to a cell dataset for non-periodic simulations.</p>
<figure class="align-default" id="id35">
<a class="reference internal image-reference" href="../_images/thermal_output.png"><img alt="../_images/thermal_output.png" src="../_images/thermal_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 59 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">THERMAL_output</span></code> variable.</span><a class="headerlink" href="#id35" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The input variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> has been updated with the field <code class="docutils literal notranslate"><span class="pre">thermal</span></code>, which includes the user input thermal coefficients at the start of the simulations.</p>
<figure class="align-default" id="id36">
<img alt="../_images/input_after_thermal.png" src="../_images/input_after_thermal.png" />
<figcaption>
<p><span class="caption-number">Fig. 60 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after THERMAL.</span><a class="headerlink" href="#id36" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="electric">
<h4>3.1.5 Electric<a class="headerlink" href="#electric" title="Permalink to this headline">#</a></h4>
<p>This function is used to compute the DC Energy yield of the designed PV system. On clicking the button, the first option that appears is the option to choose between data sheet values and model cell values. The model cell values can be modified with data from the ASA simulator if the user wants to do so.</p>
<p><em>If Datasheet is chosen:</em></p>
<ol class="arabic simple">
<li><p>Enter the parameters such as Voc and Isc when prompted by MATLAB. If the chosen cell is a tandem, then the user will be prompted twice to enter the properties of both the top and bottom cells.</p></li>
</ol>
<figure class="align-default" id="id37">
<a class="reference internal image-reference" href="../_images/electric_electric_properties.png"><img alt="../_images/electric_electric_properties.png" src="../_images/electric_electric_properties.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 61 </span><span class="caption-text">Enter the solar cell electrical properties.</span><a class="headerlink" href="#id37" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Model Cells is chosen:</em></p>
<ol class="arabic simple">
<li><p>Choose the model cell file from the dialog box to be used for the simulations. These are pre-loaded values obtained from the ASA simulations.</p></li>
</ol>
<figure class="align-default" id="id38">
<a class="reference internal image-reference" href="../_images/electric_model_choice.png"><img alt="../_images/electric_model_choice.png" src="../_images/electric_model_choice.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 62 </span><span class="caption-text">Choose model cell for electrical simulations.</span><a class="headerlink" href="#id38" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple" start="2">
<li><p>When prompted in the command window, enter if the modules are electrically re-configurable or not by typing <code class="docutils literal notranslate"><span class="pre">Y</span></code> or <code class="docutils literal notranslate"><span class="pre">N</span></code> <a class="footnote-reference brackets" href="#id21" id="id10">9</a>.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only 96 cell modules with a configuration of 12x8 or 8x12 are reconfigurable.</p>
</div>
<ol class="arabic simple" start="3">
<li><p>Choose the option to define the metallization losses of the solar cell.</p></li>
</ol>
<figure class="align-default" id="id39">
<img alt="../_images/electric_metallization.png" src="../_images/electric_metallization.png" />
<figcaption>
<p><span class="caption-number">Fig. 63 </span><span class="caption-text">User options for metallization losses.</span><a class="headerlink" href="#id39" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Ignore metallization losses is chosen</em></p>
<blockquote>
<div><p>Move to step 4.</p>
</div></blockquote>
<p><em>If Give shading and resistance values is chosen</em></p>
<blockquote>
<div><p>Define the resistance and shading losses values when prompted by the GUI.</p>
</div></blockquote>
<figure class="align-default" id="id40">
<a class="reference internal image-reference" href="../_images/electric_metallization_losses.png"><img alt="../_images/electric_metallization_losses.png" src="../_images/electric_metallization_losses.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 64 </span><span class="caption-text">Enter resistance and shading loss values.</span><a class="headerlink" href="#id40" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If Detailed model for metallization is chosen</em></p>
<blockquote>
<div><p>Enter the requested parameters when prompted.</p>
</div></blockquote>
<figure class="align-default" id="id41">
<a class="reference internal image-reference" href="../_images/electric_metallization_detailed_losses.png"><img alt="../_images/electric_metallization_detailed_losses.png" src="../_images/electric_metallization_detailed_losses.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 65 </span><span class="caption-text">Detailed model for metallization losses.</span><a class="headerlink" href="#id41" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<ol class="arabic simple" start="4">
<li><p>Define the number of bypass diodes present in the modules, being 0, 3 and 6 the only possible options.</p></li>
<li><p>Once the simulation is run, the user is prompted to enter the time at which the IV curve of the module is to be plotted. The details requested are: month (as an integer between 1 and 12), day and hour (as an integer between 0 and 23).</p></li>
</ol>
<p>The user is presented with two plots when the simulation is completed: a comparison between the incident energy and the DC Energy Yield (<a class="reference internal" href="#fig-electric-dc-energy"><span class="std std-numref">Fig. 66</span></a>), and the IV curve of the module (<a class="reference internal" href="#fig-electric-iv-curve"><span class="std std-numref">Fig. 67</span></a>).</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-electric-dc-energy">
<img alt="../_images/electric_dc_energy.png" src="../_images/electric_dc_energy.png" />
<figcaption>
<p><span class="caption-number">Fig. 66 </span><span class="caption-text">Resulting DC energy plot from ELECTRIC simulation.</span><a class="headerlink" href="#fig-electric-dc-energy" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-electric-iv-curve">
<img alt="../_images/electric_iv_curve.png" src="../_images/electric_iv_curve.png" />
<figcaption>
<p><span class="caption-number">Fig. 67 </span><span class="caption-text">IV curve plot.</span><a class="headerlink" href="#fig-electric-iv-curve" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The ELECTRIC simulations produce the output <code class="docutils literal notranslate"><span class="pre">ELECTRIC_output</span></code>. This output variable consists of those parameters which define the DC electrical performance and DC energy yield of the user-defined PV system. <a class="reference internal" href="#fig-electric-output"><span class="std std-numref">Fig. 68</span></a> shows the variables stored within this dataset.</p>
<figure class="align-default" id="fig-electric-output">
<a class="reference internal image-reference" href="../_images/electric_output.png"><img alt="../_images/electric_output.png" src="../_images/electric_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 68 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">ELECTRIC_output</span></code> variable.</span><a class="headerlink" href="#fig-electric-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Within this structure, the values of short-circuit current <code class="docutils literal notranslate"><span class="pre">Isc</span></code>, open-circuit voltage <code class="docutils literal notranslate"><span class="pre">Voc</span></code> and maximum power point (MPP) parameters (current, voltage and power) are stored for both operating and Standard Temperature Conditions (STC). Along with these variables, the DC energy yield is stored in the variable <code class="docutils literal notranslate"><span class="pre">DCP</span></code> for every time-step in the simulation. Again, these variables are replaced by a cell for non-periodic simulations. The final two variables represent the evolution of maximum power of the panels due to panel degradation year-on-year. These variables are appended to <code class="docutils literal notranslate"><span class="pre">ELECTRIC_output</span></code> after running the degradation simulations. Therefore, these values are included only when degradation is computed and is not present otherwise.</p>
<p>The input variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> is updated after the ELECTRIC simulations and now includes the field <code class="docutils literal notranslate"><span class="pre">electric</span></code>, where all the inputs for the electrical simulations are stored. Some of the variables are empty or missing due to the choices made in the simulation, and an example of how the dataset looks like is shown in <a class="reference internal" href="#fig-input-after-electric"><span class="std std-numref">Fig. 69</span></a>.</p>
<figure class="align-default" id="fig-input-after-electric">
<img alt="../_images/input_after_electric.png" src="../_images/input_after_electric.png" />
<figcaption>
<p><span class="caption-number">Fig. 69 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after ELECTRIC.</span><a class="headerlink" href="#fig-input-after-electric" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="degradation">
<h4>3.1.6 Degradation<a class="headerlink" href="#degradation" title="Permalink to this headline">#</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Outputs results only for yearly simulations, otherwise output is stored as <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</div>
<p>This sub function is used to visualize how the performance of the modules degrade year-on-year. On clicking the GUI button, the user is first asked to input the number of years for which panel degradation is to be simulated, being 50 the maximum possible.</p>
<p>The user is then presented with three options to model the degradation via a list dialog box.</p>
<figure class="align-default" id="id42">
<a class="reference internal image-reference" href="../_images/degradation_modelling_choice.png"><img alt="../_images/degradation_modelling_choice.png" src="../_images/degradation_modelling_choice.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 70 </span><span class="caption-text">Choose modelling option for degradation.</span><a class="headerlink" href="#id42" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If User defined Degradation Rate is chosen:</em></p>
<blockquote>
<div><p>The user is prompted via the command window to enter the percentage degradation rate.</p>
</div></blockquote>
<p><em>If Approximate Power Degradation using Kaaya Model is chosen [14]:</em></p>
<blockquote>
<div><p>No external inputs necessary. The module specific degradation behaviour from Kaaya <em>et al.</em> <a class="footnote-reference brackets" href="#id22" id="id11">10</a> is assumed and the climate specific aspect is calculate based on the weather data.</p>
</div></blockquote>
<p><em>If Detailed Degradation using Kaaya Model is chosen:</em></p>
<blockquote>
<div><p>When prompted, enter <code class="docutils literal notranslate"><span class="pre">Y</span></code> for <em>yes</em> and <code class="docutils literal notranslate"><span class="pre">N</span></code> for <em>no</em> if degradation parameters are to be calculated using data for the silicon module. No values are used when <code class="docutils literal notranslate"><span class="pre">N</span></code> is selected. If <code class="docutils literal notranslate"><span class="pre">Y</span></code> is selected, then the default values for silicon will be input.</p>
</div></blockquote>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Detailed degradation model is extremely time intensive and thus not recommended</p>
</div>
<p>Once the degradation calculations are completed, the plots related to the degradation performance of the modules are displayed on the screen. For non-periodic simulations, this data is shown for each module present in the scene.</p>
<figure class="align-default" id="id43">
<a class="reference internal image-reference" href="../_images/degradation_plots.png"><img alt="../_images/degradation_plots.png" src="../_images/degradation_plots.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 71 </span><span class="caption-text">Plots from DEGRADATION.</span><a class="headerlink" href="#id43" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The output variable from this simulation is <code class="docutils literal notranslate"><span class="pre">DEGRADATION_output</span></code>. This variable holds the values pertaining to the degradation rate of the chosen PV panel during the lifetime or work life of the system. Therefore, this variable holds the values related to the contribution of each physical phenomenon to the degradation of the PV panels and the evolution of the normalised power output of the system during its lifetime as shown in <a class="reference internal" href="#fig-degradation-output"><span class="std std-numref">Fig. 72</span></a> (for the Kaaya model). The values starting with <code class="docutils literal notranslate"><span class="pre">R</span></code> in Figure 3.55 denote the degradation rates of the panel due to various physical phenomenon.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The values stored in the variables change if the chosen user inputs are different. Test the different choices to learn about the nature of the outputs.</p>
</div>
<p>Within <code class="docutils literal notranslate"><span class="pre">DEGRADATION_output</span></code>, the variable <code class="docutils literal notranslate"><span class="pre">NORMALIZEDPOWER_output</span></code> stores the normalised power of the system during its entire lifetime and also holds the values of each phenomenon contributing to the degradation of panel performance, stored in the variables starting with <code class="docutils literal notranslate"><span class="pre">PR</span></code>. This is shown in <a class="reference internal" href="#fig-degradation-normalized-power"><span class="std std-numref">Fig. 73</span></a>. For non-periodic simulations, all values are stored in the form of a cell.</p>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-degradation-output">
<img alt="../_images/degradation_output.png" src="../_images/degradation_output.png" />
<figcaption>
<p><span class="caption-number">Fig. 72 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">DEGRADATION_output</span></code> variable.</span><a class="headerlink" href="#fig-degradation-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-degradation-normalized-power">
<img alt="../_images/degradation_normalized_power.png" src="../_images/degradation_normalized_power.png" />
<figcaption>
<p><span class="caption-number">Fig. 73 </span><span class="caption-text">Variable <code class="docutils literal notranslate"><span class="pre">NORMALIZEDPOWER_output</span></code> within <code class="docutils literal notranslate"><span class="pre">DEGRADATION_output</span></code>.</span><a class="headerlink" href="#fig-degradation-normalized-power" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The input variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> holds the field <code class="docutils literal notranslate"><span class="pre">Degradation</span></code>, which again, stores the inputs provided by the user during the degradation simulations.</p>
<figure class="align-default" id="id44">
<img alt="../_images/input_after_degradation.png" src="../_images/input_after_degradation.png" />
<figcaption>
<p><span class="caption-number">Fig. 74 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after DEGRADATION.</span><a class="headerlink" href="#id44" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="conversion">
<h4>3.1.7 Conversion<a class="headerlink" href="#conversion" title="Permalink to this headline">#</a></h4>
<p>This function is used to compute the AC energy yield of the defined PV system. On clicking the GUI, the user is requested to enter the type of inverter to be used in the simulations.</p>
<figure class="align-default" id="id45">
<a class="reference internal image-reference" href="../_images/conversion_inverter_type.png"><img alt="../_images/conversion_inverter_type.png" src="../_images/conversion_inverter_type.png" style="width: 300px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 75 </span><span class="caption-text">Choose inverter type.</span><a class="headerlink" href="#id45" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If central or string inverter is chosen</em></p>
<ol class="arabic simple">
<li><p>When prompted in the command window, enter the number of strings present in the PV system. For periodic simulations, the user also has to enter the number of modules in parallel.</p></li>
<li><p>Choose the inverter to be used in the simulations from the list that appears on the screen (<a class="reference internal" href="#fig-conversion-inverter-model"><span class="std std-numref">Fig. 76</span></a>) [15].</p></li>
</ol>
<figure class="align-default" id="fig-conversion-inverter-model">
<a class="reference internal image-reference" href="../_images/conversion_inverter_model.png"><img alt="../_images/conversion_inverter_model.png" src="../_images/conversion_inverter_model.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 76 </span><span class="caption-text">Choose inverter model for the simulations.</span><a class="headerlink" href="#fig-conversion-inverter-model" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p><em>If micro inverter is chosen</em></p>
<ol class="arabic simple">
<li><p>When prompted, enter the total number of modules in the PV system.</p></li>
<li><p>Choose the inverter to be used in the simulations from the list that appears on the screen (as in <a class="reference internal" href="#fig-conversion-inverter-model"><span class="std std-numref">Fig. 76</span></a>) <a class="footnote-reference brackets" href="#id23" id="id12">11</a>.</p></li>
</ol>
<p><em>If power optimizer is chosen</em></p>
<ol class="arabic simple">
<li><p>A dialog box will be prompted to select the manufacturer of the power optimizer. Two options are given: <em>Solar Edge</em> or <em>User specified</em>. The latter option is not recommended for non advanced users since it requires a template to be filled (refer to Appendix <a class="reference internal" href="#appendix-d"><span class="std std-ref">D. User Specified template for power optimizers</span></a> for more information). Therefore, select <em>Solar Edge</em> from the dialog box.</p></li>
<li><p>From the List of power optimizers which are displayed, choose the one of interest.</p></li>
</ol>
<figure class="align-default" id="id46">
<a class="reference internal image-reference" href="../_images/conversion_power_optimizer.png"><img alt="../_images/conversion_power_optimizer.png" src="../_images/conversion_power_optimizer.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 77 </span><span class="caption-text">Choose power optimizer model.</span><a class="headerlink" href="#id46" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If a maximum voltage warning is displayed, rerun the CONVERSION simulation and choose another power optimizer with higher input voltage.</p>
</div>
<p>When prompted in the command window, enter <code class="docutils literal notranslate"><span class="pre">Y</span></code> if a central inverter is to be added to the simulation, otherwise enter <code class="docutils literal notranslate"><span class="pre">N</span></code>.</p>
<p><em>If</em> <code class="docutils literal notranslate"><span class="pre">Y</span></code> <em>is chosen</em></p>
<p>Choose <em>Solar Edge</em> from the list dropdown as explained during the selection of the power optimizer manufacturer. Choose the inverter of interest from the list of inverters displayed.</p>
<figure class="align-default" id="id47">
<a class="reference internal image-reference" href="../_images/conversion_inverter_power_optimizer.png"><img alt="../_images/conversion_inverter_power_optimizer.png" src="../_images/conversion_inverter_power_optimizer.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 78 </span><span class="caption-text">Choose central inverter model for power optimizer.</span><a class="headerlink" href="#id47" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Enter the number of strings when prompted in the command window. For periodic simulations, the user also has to enter the number of modules in parallel.</p>
<ol class="arabic simple" start="3">
<li><p>Enter yes <code class="docutils literal notranslate"><span class="pre">Y</span></code> or no <code class="docutils literal notranslate"><span class="pre">N</span></code> in the command window to include cable losses in the simulations. If <code class="docutils literal notranslate"><span class="pre">N</span></code> is chosen, then cable losses are skipped.</p></li>
</ol>
<p><em>If ``Y`` is chosen</em></p>
<ol class="arabic simple" start="4">
<li><p>Choose whether to have a detailed simulation or a fixed percentage of cable losses from the list.</p></li>
</ol>
<p><em>If Fixed Percentage for Cable Losses is chosen</em></p>
<blockquote>
<div><p>Specify the overall cable loss percentage in the dialog box when prompted.</p>
</div></blockquote>
<p><em>If Detailed Calculation is chosen</em></p>
<blockquote>
<div><p>Enter the requested parameters from the interactive dropdown dialog box for defining the cable properties of the string (<a class="reference internal" href="#fig-conversion-cable-properties"><span class="std std-numref">Fig. 79</span></a>).</p>
</div></blockquote>
<figure class="align-default" id="fig-conversion-cable-properties">
<a class="reference internal image-reference" href="../_images/conversion_cable_properties.png"><img alt="../_images/conversion_cable_properties.png" src="../_images/conversion_cable_properties.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 79 </span><span class="caption-text">String cable properties.</span><a class="headerlink" href="#fig-conversion-cable-properties" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Enter the requested parameters from the interactive dropdown dialog box for defining the cable properties of the inverter (dialog box similar to one in <a class="reference internal" href="#fig-conversion-cable-properties"><span class="std std-numref">Fig. 79</span></a>).</p>
<ol class="arabic simple" start="5">
<li><p>When prompted, enter <code class="docutils literal notranslate"><span class="pre">Y</span></code> if the results are to be plotted for the simulations, else enter <code class="docutils literal notranslate"><span class="pre">N</span></code>. If results are to be plotted, two plots are produced: the inverter efficiency plot (<a class="reference internal" href="#fig-conversion-inverter-efficiency"><span class="std std-numref">Fig. 80</span></a>) and the inverter AC output plot (<a class="reference internal" href="#fig-conversion-ac-power"><span class="std std-numref">Fig. 81</span></a>).</p></li>
</ol>
<table class="table">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><figure class="align-default" id="fig-conversion-inverter-efficiency">
<img alt="../_images/conversion_inverter_efficiency.png" src="../_images/conversion_inverter_efficiency.png" />
<figcaption>
<p><span class="caption-number">Fig. 80 </span><span class="caption-text">Resulting inverter efficiency plot from CONVERSION simulation.</span><a class="headerlink" href="#fig-conversion-inverter-efficiency" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
<td><figure class="align-default" id="fig-conversion-ac-power">
<img alt="../_images/conversion_ac_power.png" src="../_images/conversion_ac_power.png" />
<figcaption>
<p><span class="caption-number">Fig. 81 </span><span class="caption-text">Resulting AC output plot.</span><a class="headerlink" href="#fig-conversion-ac-power" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</td>
</tr>
</tbody>
</table>
<p>The outputs from the CONVERSION simulation are stored in the variable <code class="docutils literal notranslate"><span class="pre">CONVERSION_output</span></code>. This variable stores the parameters related to the AC Energy Yield of the designed PV system, based on the inverter type and configuration chosen by the user. This struct therefore includes the variables defining overall inverter efficiency <code class="docutils literal notranslate"><span class="pre">eff_overall</span></code>, inverter efficiency at every time-step in the simulation <code class="docutils literal notranslate"><span class="pre">eff</span></code> and the overall AC power output <code class="docutils literal notranslate"><span class="pre">Pac</span></code>. This variable also includes the DC power input <code class="docutils literal notranslate"><span class="pre">Pdc</span></code> to the inverter based on the system configuration (such as a central/string inverter). This is denoted by variable <code class="docutils literal notranslate"><span class="pre">INV_TYPE</span></code>. An example of this variable is depicted in <a class="reference internal" href="#fig-conversion-output"><span class="std std-numref">Fig. 82</span></a>. Similar to other functions, these variables are stored in a cell for Non-periodic simulations.</p>
<figure class="align-default" id="fig-conversion-output">
<a class="reference internal image-reference" href="../_images/conversion_output.png"><img alt="../_images/conversion_output.png" src="../_images/conversion_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 82 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">CONVERSION_output</span></code> variable.</span><a class="headerlink" href="#fig-conversion-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The input variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> is updated with the inclusion of the field <code class="docutils literal notranslate"><span class="pre">Conversion</span></code>. This field includes the data related to configuration of the PV system and the data obtained from the cable loss calculations (<a class="reference internal" href="#fig-input-after-conversion"><span class="std std-numref">Fig. 83</span></a>).</p>
<figure class="align-default" id="fig-input-after-conversion">
<img alt="../_images/input_after_conversion.png" src="../_images/input_after_conversion.png" />
<figcaption>
<p><span class="caption-number">Fig. 83 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after CONVERSION.</span><a class="headerlink" href="#fig-input-after-conversion" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="financials">
<h4>3.1.8 Financials<a class="headerlink" href="#financials" title="Permalink to this headline">#</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Financial calculations are only performed for yearly simulations. Otherwise the output is <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p>
</div>
<p>This function is used to compute the Levelised Cost of Electricity (LCOE) of the designed PV system. On clicking the FINANCIALS button in the GUI, a dialog box appears into which the user has to enter the financial parameters of the system.</p>
<figure class="align-default" id="id48">
<a class="reference internal image-reference" href="../_images/financials_parameters.png"><img alt="../_images/financials_parameters.png" src="../_images/financials_parameters.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 84 </span><span class="caption-text">Financial Parameters of the system.</span><a class="headerlink" href="#id48" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Choose the scenario for performing the LCOE calculations. There are two possible options: use the same module until the required years, or the modules are replaced by new technology ones until the required years. For the former option, no further steps are required.</p>
<p><em>If New technology modules replaced till required years is chosen</em></p>
<blockquote>
<div><p>Select the financial growth rate of the PV technology.</p>
</div></blockquote>
<figure class="align-default" id="id49">
<a class="reference internal image-reference" href="../_images/financials_growth_rate.png"><img alt="../_images/financials_growth_rate.png" src="../_images/financials_growth_rate.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 85 </span><span class="caption-text">Select growth rate of chosen technology.</span><a class="headerlink" href="#id49" title="Permalink to this image">#</a></p>
<div class="legend">
<p>The results are plotted once the simulations are completed, as shown in <a class="reference internal" href="#fig-financials-lcoe"><span class="std std-numref">Fig. 86</span></a> and the results are stored in the variable <code class="docutils literal notranslate"><span class="pre">LCOE_output</span></code>.</p>
</div>
</figcaption>
</figure>
<figure class="align-default" id="fig-financials-lcoe">
<a class="reference internal image-reference" href="../_images/financials_lcoe.png"><img alt="../_images/financials_lcoe.png" src="../_images/financials_lcoe.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 86 </span><span class="caption-text">LCOE results.</span><a class="headerlink" href="#fig-financials-lcoe" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A snippet of the variable <code class="docutils literal notranslate"><span class="pre">LCOE_output</span></code> is shown in <a class="reference internal" href="#fig-financials-output"><span class="std std-numref">Fig. 87</span></a>. This is obtained after performing the financial calculations and holds the value of the levelised cost of electricity of the defined system <code class="docutils literal notranslate"><span class="pre">LCOE_1</span></code> and present value of the total levelised cost during system lifetime <code class="docutils literal notranslate"><span class="pre">SystemCost_dis_1</span></code>. Moreover, this output also stores the energy produced during every year of operation of the system and total energy produced during the PV system’s operational life <code class="docutils literal notranslate"><span class="pre">Energy_1</span></code> and <code class="docutils literal notranslate"><span class="pre">Energy_dis_1</span></code>. The value <cite>1</cite> denotes the scenario used for the simulations and can change up to <cite>3</cite> based on user inputs.</p>
<figure class="align-default" id="fig-financials-output">
<a class="reference internal image-reference" href="../_images/financials_output.png"><img alt="../_images/financials_output.png" src="../_images/financials_output.png" style="width: 400px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 87 </span><span class="caption-text"><code class="docutils literal notranslate"><span class="pre">LCOE_output</span></code> variable.</span><a class="headerlink" href="#fig-financials-output" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The input variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> now contains the final input field from the simulations, called <code class="docutils literal notranslate"><span class="pre">FinancialPart</span></code>. This variable includes the inputs to the financial simulations such as the cost of the system and the discount rate for the LCOE calculations.</p>
<figure class="align-default" id="id50">
<img alt="../_images/input_after_financials.png" src="../_images/input_after_financials.png" />
<figcaption>
<p><span class="caption-number">Fig. 88 </span><span class="caption-text">The updated <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input</span></code> variable after FINANCIALS.</span><a class="headerlink" href="#id50" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>This concludes the simulations from the GUI. In the next section, the script version of the PVMD TOOLBOX will be illustrated.</p>
</section>
</section>
<section id="pvmd-toolbox-script-version">
<h3>3.2 PVMD Toolbox Script Version<a class="headerlink" href="#pvmd-toolbox-script-version" title="Permalink to this headline">#</a></h3>
<p>The PVMD Toolbox also includes a script version, where the user can run the simulations without having to use the GUI. The script version can be run using two files:</p>
<ol class="arabic simple">
<li><p>The toolbox input struct creator</p></li>
<li><p>The function PVMD toolbox script</p></li>
</ol>
<p>Below one can find a snippet of the input struct creator function</p>
<div class="highlight-matlab notranslate"><div class="highlight"><pre><span></span><span class="k">function</span><span class="w"> </span><span class="nf">TB_input_creator</span><span class="p">(</span>outputName<span class="p">)</span><span class="w"></span>

<span class="nb">disp</span><span class="p">(</span><span class="s">&#39;Generating Input Struct for TOOLBOX...&#39;</span><span class="p">);</span><span class="w"></span>
<span class="c">% Needs to be true for the script version to run</span><span class="w"></span>
<span class="n">TOOLBOX_input</span><span class="p">.</span><span class="n">script</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>

<span class="c">% If true cell part of toolbox is called</span><span class="w"></span>
<span class="n">TOOLBOX_input</span><span class="p">.</span><span class="n">runDeviceOptic</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span><span class="w"></span>

<span class="c">% Set to true for genpro simulations</span><span class="w"></span>
<span class="n">TOOLBOX_input</span><span class="p">.</span><span class="n">deviceOptic</span><span class="p">.</span><span class="n">runGenPro</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="nb">false</span><span class="p">;</span><span class="w"></span>

<span class="c">% Loading GenPRO file, change for new simulations, change if runGenPro is true</span><span class="w"></span>
<span class="n">TOOLBOX_input</span><span class="p">.</span><span class="n">deviceOptic</span><span class="p">.</span><span class="n">GenProFile</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;MonoPERC.mat&#39;</span><span class="p">;</span><span class="w"></span>

<span class="c">% Type of cell selected for simulations</span><span class="w"></span>
<span class="n">celltype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="n">TOOLBOX_input</span><span class="p">.</span><span class="n">deviceOptic</span><span class="p">.</span><span class="n">GenProFile</span><span class="p">;</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="nb">contains</span><span class="p">(</span><span class="n">celltype</span><span class="p">,</span><span class="s">&#39;Tandem&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">celltype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;tandem&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">elseif</span><span class="w"> </span><span class="nb">contains</span><span class="p">(</span><span class="n">celltype</span><span class="p">,</span><span class="s">&#39;Bifacial&#39;</span><span class="p">)</span><span class="w"></span>
<span class="w">    </span><span class="n">celltype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;bifacial&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">else</span><span class="w"></span>
<span class="w">    </span><span class="n">celltype</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s">&#39;normal&#39;</span><span class="p">;</span><span class="w"></span>
<span class="k">end</span><span class="w"></span>
</pre></div>
</div>
<p>Within this function, all variables (logical as well as input data) are assigned and output for use in the toolbox. The logical variable <code class="docutils literal notranslate"><span class="pre">TOOLBOX_input.deviceOptic.runGenPro</span></code> has been set to <code class="docutils literal notranslate"><span class="pre">false</span></code>. This means that GenPro will not be run when using the script version. However, if a user wishes to run GenPro, then this logical value can be changed to <code class="docutils literal notranslate"><span class="pre">true</span></code>. Similarly, this function includes the assignment statements for all the input variables used to run the toolbox and can be changed by the user based on their requirements.</p>
<p>In order to run this function, type <code class="docutils literal notranslate"><span class="pre">TB_input_creator(outputName)</span></code> in the command window, being outputName the <em>.mat</em> filename where the input structure was saved. Before running the script, if the user wishes to change certain parameters, follow the comments mentioned in the function and change the values accordingly.</p>
<p>Once the input struct has been created, use this to run the script version by typing <code class="docutils literal notranslate"><span class="pre">TB_script('outputName.mat')</span></code> in the MATLAB command window. This will start running the functions within the toolbox. Once a function has finished calculations, a message will be displayed on the command window.</p>
</section>
</section>
<section id="software-limitations">
<h2>4. Software limitations<a class="headerlink" href="#software-limitations" title="Permalink to this headline">#</a></h2>
<p>The following have been specified as scope for future improvements by the developers of this Toolbox:</p>
<ol class="arabic simple">
<li><p>This version has certain functions which are semi-automated (eg: Non-periodic simulations required multiple programs)</p></li>
<li><p>Run-time for very large datasets (such as yearly simulations) will be very high</p></li>
<li><p>Assigning materials to external 3D objects during non-periodic simulations is cumbersome</p></li>
<li><p>Selection of points to place panels on surfaces of external 3D objects in non-periodic simulations is primitive</p></li>
<li><p>Re-configurable modules are only possible for specific cases</p></li>
</ol>
</section>
<section id="version-summary">
<h2>5. Version summary<a class="headerlink" href="#version-summary" title="Permalink to this headline">#</a></h2>
<p>The PVMD TOOLBOX 2.0 has the following updates:</p>
<ol class="arabic simple">
<li><p>Conversion of GUIDE based GUI to MATLAB App Developer platform.</p></li>
<li><p>Inclusion of PV systems with non-periodic properties (such as shading, difference in incident irradiation &amp; cell temperatures)</p></li>
<li><p>Capability to model electrically re-configurable modules</p></li>
<li><p>New feature to determine and visualize the degradation performance of PV panels in extensive detail</p></li>
<li><p>Enumerate the financial performance of user-defined PV system by computing the LCOE of the system</p></li>
</ol>
</section>
<section id="acknowledgements">
<h2>6. Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">#</a></h2>
<p>The PVMD TOOLBOX 2.0 has been designed and developed by the following members of the PVMD Group:</p>
<ol class="arabic simple">
<li><p>Dr. Rudi Santbergen</p></li>
<li><p>Dr. Malte Vogt</p></li>
<li><p>Dr. Miro Zeman</p></li>
<li><p>Dr. Olindo Isabella</p></li>
<li><p>Alba Alcañiz Moya</p></li>
<li><p>Andres Calcabrini</p></li>
<li><p>Karthik Ganapathi Subramanian</p></li>
<li><p>Abhishek Velpuru</p></li>
<li><p>Devyani Salokhe</p></li>
<li><p>Elias Garcia Goma</p></li>
<li><p>Julien Garo Etxebarria</p></li>
<li><p>Ignacio Narváez Alavez</p></li>
<li><p>Zidan Wang</p></li>
<li><p>Tim Stark</p></li>
<li><p>Abdallah Nour el Din</p></li>
</ol>
</section>
<section id="references">
<h2>7. References<a class="headerlink" href="#references" title="Permalink to this headline">#</a></h2>
<dl class="footnote brackets">
<dt class="label" id="id13"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><p>Santbergen <em>et al.</em>, “ASA Software for Opto-Electrical Simulation of Silicon, CIGS and Perovskite Solar Cells” presented at the Asian PVSEC, Xian (China), 2019</p></li>
</ol>
</dd>
<dt class="label" id="id14"><span class="brackets"><a class="fn-backref" href="#id2">2</a></span></dt>
<dd><ol class="upperalpha simple" start="4">
<li><p>Geisler-Moroder and A. Dür “A new Ward BRDF model with bounded albedo” <em>Computer Graphics Forum</em> (2010), 29(4): 1391–1398</p></li>
</ol>
</dd>
<dt class="label" id="id15"><span class="brackets"><a class="fn-backref" href="#id3">3</a></span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><p>Santbergen <em>et al.</em>, “GenPro4 Optical Model for Solar Cell Simulation and Its Application to Multijunction Solar Cells” <em>IEEE J. Photovoltaics</em> (2017), vol. 7, no. 3, pp. 919–926, doi: 10.1109/JPHOTOV.2017.2669640.</p></li>
</ol>
</dd>
<dt class="label" id="id16"><span class="brackets"><a class="fn-backref" href="#id4">4</a></span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><p>Santbergen <em>et al.</em>, “Calculation of irradiance distribution on PV modules by combining sky and sensitivity maps” <em>Sol. Energy</em> (2017), vol. 150, pp. 49–54, doi: 10.1016/j.solener.2017.04.036</p></li>
</ol>
</dd>
<dt class="label" id="id17"><span class="brackets">5</span><span class="fn-backref">(<a href="#id5">1</a>,<a href="#id6">2</a>)</span></dt>
<dd><ol class="upperalpha simple" start="6">
<li><ol class="upperalpha simple" start="6">
<li><p>Sönmez <em>et al.</em> “Fast and accurate ray-casting-based view factor estimation method for complex geometries” <em>Solar Energy Materials and Solar Cells</em> (2019) 200: 109934</p></li>
</ol>
</li>
</ol>
</dd>
<dt class="label" id="id18"><span class="brackets"><a class="fn-backref" href="#id7">6</a></span></dt>
<dd><ol class="upperalpha simple" start="18">
<li><p>Perez <em>et al.</em> “All-weather model for sky luminance distribution—Preliminary configuration and validation” <em>Solar Energy</em> (1993), vol. 50, no. 3, pp. 235–245, doi: 10.1016/0038-092X(93)90017-I.</p></li>
</ol>
</dd>
<dt class="label" id="id19"><span class="brackets"><a class="fn-backref" href="#id8">7</a></span></dt>
<dd><ol class="upperalpha simple" start="3">
<li><p>Gueymard, “Simple Model for the Atmospheric Radiative Transfer of Sunshine (SMARTS2) Algorithms and performance assessment” p. 84.</p></li>
</ol>
</dd>
<dt class="label" id="id20"><span class="brackets"><a class="fn-backref" href="#id9">8</a></span></dt>
<dd><ol class="upperalpha simple" start="13">
<li><ol class="upperalpha simple" start="11">
<li><p>Fuentes, “A Simplified Thermal Model for Flat-Plate Photovoltaic Arrays” p. 60.</p></li>
</ol>
</li>
</ol>
</dd>
<dt class="label" id="id21"><span class="brackets"><a class="fn-backref" href="#id10">9</a></span></dt>
<dd><ol class="upperalpha simple" start="4">
<li><p>Salokhe “Control Strategies for Reconfigurable PV Modules” <em>Delft University of Technology</em> (2021)</p></li>
</ol>
</dd>
<dt class="label" id="id22"><span class="brackets"><a class="fn-backref" href="#id11">10</a></span></dt>
<dd><ol class="upperroman simple">
<li><p>Kaaya <em>et al.</em> “Photovoltaic Lifetime Forecast: Models for long-term photovoltaic degradation prediction and forecast” <em>UMA Editorial PP</em> (2020), pp. 22–32. doi: <a class="reference external" href="https://hdl.handle.net/10630/19789.3">https://hdl.handle.net/10630/19789.3</a></p></li>
</ol>
</dd>
<dt class="label" id="id23"><span class="brackets"><a class="fn-backref" href="#id12">11</a></span></dt>
<dd><ol class="upperalpha simple" start="23">
<li><p>Boyson <em>et al.</em> “Performance model for grid-connected photovoltaic inverters” SAND2007-5036, 920449 (2007) doi: 10.2172/920449.</p></li>
</ol>
</dd>
</dl>
<p>PVMD Group, Delft University of Technology, Delft, the Netherlands</p>
<p>©All rights reserved</p>
</section>
<section id="appendix">
<h2>Appendix<a class="headerlink" href="#appendix" title="Permalink to this headline">#</a></h2>
<section id="a-information-on-material-reflectances">
<span id="appendix-a"></span><h3>A. Information on material reflectances<a class="headerlink" href="#a-information-on-material-reflectances" title="Permalink to this headline">#</a></h3>
<p>The material reflectance data which is provided from NASA’s ECOSTRESS Library contains the reflectivity of the material for every wavelength in the range of 300 nm to 15000 nm. A sample of the data provided by NASA is shown in <a class="reference internal" href="#fig-appendix-material-reflectance"><span class="std std-numref">Fig. 89</span></a>. As this toolbox is used for solar simulations, we are interested in the wavelength range of 250 - 1500 nm.</p>
<figure class="align-default" id="fig-appendix-material-reflectance">
<a class="reference internal image-reference" href="../_images/appendix_material_reflectance.png"><img alt="../_images/appendix_material_reflectance.png" src="../_images/appendix_material_reflectance.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 89 </span><span class="caption-text">Material reflectance from the NASA Library.</span><a class="headerlink" href="#fig-appendix-material-reflectance" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Therefore, data provided by NASA beyond 1500 nm is truncated to match the required wavelength range. Moreover, to obtain data in the range of 250-300 nm, the reflectivity is linearly extrapolated. However, the data in this material library cannot be directly used in the toolbox, and has to be converted to a syntax which can be used by Radiance’s ray-tracing engine. This is because Radiance uses the following syntax:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">primitive</span> <span class="n">material_name</span>
<span class="mi">0</span>
<span class="mi">0</span>
<span class="mi">5</span> <span class="n">R</span> <span class="n">G</span> <span class="n">B</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>
</div>
<p>Within this definition, the reflectance values are stored in the 3 channels marked in bold (R,G &amp; B). The reflectivity stored in these channels lie in the range 0-1. In order to convert the vast dataset provided by NASA into these 3 values, we use the term spectrally integrated albedo [a1]. The formula to convert this dataset is:</p>
<div class="math notranslate nohighlight">
\[\alpha(y) = \frac{\int_{\lambda_1}^{\lambda_2} R_y(\lambda) \cdot E_x(\lambda) d\lambda}{\int_{\lambda_1}^{\lambda_2} E_x(\lambda) d\lambda}\]</div>
<p>Where, <span class="math notranslate nohighlight">\(\alpha(y)\)</span> is the final albedo stored in the channels R, G and B, <span class="math notranslate nohighlight">\(R_y\)</span> is the spectral reflectance of the chosen material [%], <span class="math notranslate nohighlight">\(E_x\)</span> is the spectral irradiance [W/m2], <span class="math notranslate nohighlight">\(\lambda_1\)</span> and <span class="math notranslate nohighlight">\(\lambda_2\)</span> define the wavelengths [m] in the spectrum used as the limits of integration.</p>
<p>In the simulations used in the toolbox, the default wavelength ranges are as follows:</p>
<ul class="simple">
<li><p>Channel 1: 250 - 380 nm (UV range)</p></li>
<li><p>Channel 2: 381 - 760 nm (Visible range)</p></li>
<li><p>Channel 3: 761 - 1500 nm (IR range)</p></li>
</ul>
<p>These integration limits are the ones which are updated when the user uses the option Update material library in non-periodic simulations. Depending on the chosen cell chemistry and its response to different kinds of incident radiation (or in other words, the spectral response of a solar cell), the user can change the integration limits to improve the accuracy of the simulations.</p>
<p>This is the reason why the use of material data from the <em>.mtl</em> file is not recommended. Firstly, the data stored in <em>.mtl</em> files contain the R, G and B reflectivity of a material (the colour of the surface). As this data does not capture the reflectivity of the entire spectrum, the results produced using these values will also be incorrect.</p>
</section>
<section id="b-information-on-radiance-subclasses-and-testpoints">
<span id="appendix-b"></span><h3>B. Information on Radiance subclasses and testpoints<a class="headerlink" href="#b-information-on-radiance-subclasses-and-testpoints" title="Permalink to this headline">#</a></h3>
<section id="b-1-radiance-subclasses">
<h4>B.1 Radiance subclasses<a class="headerlink" href="#b-1-radiance-subclasses" title="Permalink to this headline">#</a></h4>
<p>In Appendix <a class="reference internal" href="#appendix-a"><span class="std std-ref">A. Information on material reflectances</span></a>, the material definition and its syntax in Radiance was provided in the material definition syntax. Within this definition, the term primitive defines the class the material belongs to. The class of a material represents the typical characteristic texture of a surface assigned this material. For example, if a material is assigned to the primitive metal, it will have the typical characteristic texture of a metal. This is used by Radiance during the ray-tracing simulation to accurately model reflections.</p>
<p>Four primitives are used in the PVMD toolbox: glass, mirror, plastic and metal. For highly reflective materials, mirror is used and for highly transparent materials, glass is used. Other general materials are assigned to plastic or metal. Within the toolbox, these primitives are called the Radiance subclass, as was shown in <a class="reference internal" href="#subsection-module-non-per"><span class="std std-ref">3.1.2.2 Non-periodic Simulation</span></a>.</p>
</section>
<section id="b-2-testpoints">
<h4>B.2 Testpoints<a class="headerlink" href="#b-2-testpoints" title="Permalink to this headline">#</a></h4>
<p>Radiance uses a backward ray tracing simulator, in which the rays are traced back from the sensor to the source. In the toolbox, the sensors are called testpoints, as these are the points at which the plane of array irradiance on the solar cells are computed. In a simulation, the maximum number of testpoints which can be defined are 4 per cell, owing to computational constraints. Using a single testpoint is also not recommended, as this leads to binary shading simulations (a cell is completely shaded or completely unshaded). A picture how the testpoints look on a cell is shown in the figure below.</p>
<figure class="align-default" id="id51">
<a class="reference internal image-reference" href="../_images/appendix_testpoints.png"><img alt="../_images/appendix_testpoints.png" src="../_images/appendix_testpoints.png" style="width: 350px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 90 </span><span class="caption-text">Sensors (testpoints) for the backward ray-tracing.</span><a class="headerlink" href="#id51" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>A standard testpoint definition has the following data: 1) the coordinates of a testpoint and 2) the surface normal to define the direction in which the rays travel to the source. For rear cells, the direction normal will be pointing to the ground and for the front cells, they will point to the sky.</p>
</section>
</section>
<section id="c-downloading-tif-files-for-horizon-reconstruction">
<span id="appendix-c"></span><h3>C. Downloading <em>.tif</em> files for horizon reconstruction<a class="headerlink" href="#c-downloading-tif-files-for-horizon-reconstruction" title="Permalink to this headline">#</a></h3>
<p><em>.tif</em> files include LiDAR data that can be read to reconstruct the horizon. They are really heavy, hence they should be downloaded, used and then removed or the computer will run out of space easily. For the Netherlands, LiDAR data can be downloaded from the [pdok webpage](<a class="reference external" href="https://downloads.pdok.nl/ahn3-downloadpage/">https://downloads.pdok.nl/ahn3-downloadpage/</a>). Select the region of interest in the interactive map, and download the file in the format <em>0,5 meter raster dsm</em>. Save it in the path 3_WEATHER&gt;Input&gt;horizon_reconstruction for periodic simulations, and in 2_MODULE&gt;Non-Periodic&gt;Inputs&gt;Height data for periodic ones.</p>
</section>
<section id="d-user-specified-template-for-power-optimizers">
<span id="appendix-d"></span><h3>D. User Specified template for power optimizers<a class="headerlink" href="#d-user-specified-template-for-power-optimizers" title="Permalink to this headline">#</a></h3>
<p>While using power optimizers, there is an option called <em>User specified</em> where the user can provide the electrical parameters of an external inverter or power optimizer for use in the toolbox. To access the template file <em>.xlsx</em> for power optimizers, go to: 7_CONVERSION&gt;Codes&gt;Power Optimizer Manufacturers&gt;User Specified&gt;Template.xlsx. To access the template file <em>.xlsx</em> for inverters in power optimizers, go to  PVMD Toolbox 7_CONVERSION&gt;Codes&gt;Inverter Manufacturers&gt;User Specified&gt;Template.xlsx.</p>
<p>On opening the excel file, the following table is shown. The template is the same for both inverters and Power Optimizers.</p>
<figure class="align-default" id="id52">
<img alt="../_images/appendix_user_specified.png" src="../_images/appendix_user_specified.png" />
<figcaption>
<p><span class="caption-number">Fig. 91 </span><span class="caption-text">User Specified Inverters/Power Optimizers.</span><a class="headerlink" href="#id52" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>Enter the corresponding the values and save the file. When prompted to choose the type of power optimizer and corresponding inverter, choose the template file and run the simulations.</p>
</section>
</section>
</section>


              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="../getting_started/access_guide.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Access guide to the PVMD Toolbox</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../develop/style_guide.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Style guide for the PVMD toolbox</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Malte Vogt<br/>
  
      &copy; Copyright 2022, Malte Vogt.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>